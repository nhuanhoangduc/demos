/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function g(a){throw a;}var n=void 0,p=!0,r=null,s=!1;function aa(){return function(){}}function ca(a){return function(b){this[a]=b}}function t(a){return function(){return this[a]}}var v,x=this;function da(){}
function ha(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ja(a){return a!==n}function y(a){return a!=r}function ka(a){return"array"==ha(a)}function la(a){var b=ha(a);return"array"==b||"object"==b&&"number"==typeof a.length}function A(a){return"string"==typeof a}function B(a){return"number"==typeof a}function ma(a){return"function"==ha(a)}function na(a){a=ha(a);return"object"==a||"array"==a||"function"==a}function oa(a){return a[pa]||(a[pa]=++qa)}
var pa="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),qa=0;function ra(a,b,c){return a.call.apply(a.bind,arguments)}function sa(a,b,c){a||g(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ta(a,b,c){ta=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ra:sa;return ta.apply(r,arguments)}function ua(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var va=Date.now||function(){return+new Date};
function C(a,b){var c=a.split("."),d=x;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ja(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function D(a,b){function c(){}c.prototype=b.prototype;a.C=b.prototype;a.prototype=new c};window["X.Counter"]=function(){var a=0;return{ye:function(){a+=1},ph:function(){a+=-1},value:function(){return a}}}();
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&g(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});C("Function.prototype.bind",Function.prototype.bind);function wa(a){if(!xa.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(ya,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Aa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ba,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ca,"&quot;"));return a}var ya=/&/g,Aa=/</g,Ba=/>/g,Ca=/\"/g,xa=/[&<>\"]/;var Da,Ea,Fa,Ga,Ha,Ia,Ja;function Ka(){return x.navigator?x.navigator.userAgent:r}function La(){return x.navigator}Ha=Ga=Fa=Ea=Da=s;var Ma;if(Ma=Ka()){var Na=La();Da=0==Ma.indexOf("Opera");Ea=!Da&&-1!=Ma.indexOf("MSIE");Ga=(Fa=!Da&&-1!=Ma.indexOf("WebKit"))&&-1!=Ma.indexOf("Mobile");Ha=!Da&&!Fa&&"Gecko"==Na.product}var Oa=Da,F=Ea,Pa=Ha,G=Fa,Qa=Ga,Sa,Ta=La();Sa=Ta&&Ta.platform||"";Ia=-1!=Sa.indexOf("Mac");Ja=-1!=Sa.indexOf("Win");var Ua=!!La()&&-1!=(La().appVersion||"").indexOf("X11"),Va;
a:{var Wa="",Xa;if(Oa&&x.opera)var Ya=x.opera.version,Wa="function"==typeof Ya?Ya():Ya;else if(Pa?Xa=/rv\:([^\);]+)(\)|;)/:F?Xa=/MSIE\s+([^\);]+)(\)|;)/:G&&(Xa=/WebKit\/(\S+)/),Xa)var Za=Xa.exec(Ka()),Wa=Za?Za[1]:"";if(F){var $a,ab=x.document;$a=ab?ab.documentMode:n;if($a>parseFloat(Wa)){Va=""+$a;break a}}Va=Wa}var bb={};
function H(a){var b;if(!(b=bb[a])){b=0;for(var c=(""+Va).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var h=c[f]||"",i=d[f]||"",k=RegExp("(\\d*)(\\D*)","g"),o=RegExp("(\\d*)(\\D*)","g");do{var q=k.exec(h)||["","",""],l=o.exec(i)||["","",""];if(0==q[0].length&&0==l[0].length)break;b=((0==q[1].length?0:parseInt(q[1],10))<(0==l[1].length?0:parseInt(l[1],10))?-1:(0==q[1].length?0:parseInt(q[1],
10))>(0==l[1].length?0:parseInt(l[1],10))?1:0)||((0==q[2].length)<(0==l[2].length)?-1:(0==q[2].length)>(0==l[2].length)?1:0)||(q[2]<l[2]?-1:q[2]>l[2]?1:0)}while(0==b)}b=bb[a]=0<=b}return b}var cb={};function db(a){return cb[a]||(cb[a]=F&&document.documentMode&&document.documentMode>=a)};function eb(a,b){for(var c in a)b.call(n,a[c],c,a)}function fb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function gb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var hb="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function ib(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<hb.length;f++)c=hb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var J=Array.prototype,jb=J.indexOf?function(a,b,c){return J.indexOf.call(a,b,c)}:function(a,b,c){c=c==r?0:0>c?Math.max(0,a.length+c):c;if(A(a))return!A(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},kb=J.forEach?function(a,b,c){J.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=A(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},lb=J.map?function(a,b,c){return J.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=A(a)?a.split(""):
a,h=0;h<d;h++)h in f&&(e[h]=b.call(c,f[h],h,a));return e},mb=J.some?function(a,b,c){return J.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=A(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return p;return s},nb=J.every?function(a,b,c){return J.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=A(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return s;return p};function ob(a,b){var c=jb(a,b);0<=c&&J.splice.call(a,c,1)}
function pb(a){return J.concat.apply(J,arguments)}function qb(a){if(ka(a))return pb(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function rb(a,b,c){return 2>=arguments.length?J.slice.call(a,b):J.slice.call(a,b,c)};function sb(a){if("function"==typeof a.aa)a=a.aa();else if(la(a)||A(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function tb(a){if("function"==typeof a.ba)return a.ba();if(A(a))return a.split("");if(la(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return fb(a)}
function yb(a,b){if("function"==typeof a.every)return a.every(b,n);if(la(a)||A(a))return nb(a,b,n);var c;if("function"==typeof a.Lb)c=a.Lb();else if("function"!=typeof a.ba)if(la(a)||A(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=gb(a);else c=n;for(var d=tb(a),e=d.length,f=0;f<e;f++)if(!b.call(n,d[f],c&&c[f],a))return s;return p};var zb="StopIteration"in x?x.StopIteration:Error("StopIteration");function Ab(){}Ab.prototype.next=function(){g(zb)};Ab.prototype.tb=function(){return this};function Bb(a){if(a instanceof Ab)return a;if("function"==typeof a.tb)return a.tb(s);if(la(a)){var b=0,c=new Ab;c.next=function(){for(;;){b>=a.length&&g(zb);if(b in a)return a[b++];b++}};return c}g(Error("Not implemented"))}
function Cb(a,b){if(la(a))try{kb(a,b,n)}catch(c){c!==zb&&g(c)}else{a=Bb(a);try{for(;;)b.call(n,a.next(),n,a)}catch(d){d!==zb&&g(d)}}};function Db(a,b){this.q={};this.k=[];var c=arguments.length;if(1<c){c%2&&g(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.gd(a)}v=Db.prototype;v.g=0;v.ac=0;v.aa=t("g");v.ba=function(){Eb(this);for(var a=[],b=0;b<this.k.length;b++)a.push(this.q[this.k[b]]);return a};v.Lb=function(){Eb(this);return this.k.concat()};v.ld=function(a){for(var b=0;b<this.k.length;b++){var c=this.k[b];if(Fb(this.q,c)&&this.q[c]==a)return p}return s};
v.Hb=function(a,b){if(this===a)return p;if(this.g!=a.aa())return s;var c=b||Gb;Eb(this);for(var d,e=0;d=this.k[e];e++)if(!c(this.get(d),a.get(d)))return s;return p};function Gb(a,b){return a===b}v.clear=function(){this.q={};this.ac=this.g=this.k.length=0};v.remove=function(a){return Fb(this.q,a)?(delete this.q[a],this.g--,this.ac++,this.k.length>2*this.g&&Eb(this),p):s};
function Eb(a){if(a.g!=a.k.length){for(var b=0,c=0;b<a.k.length;){var d=a.k[b];Fb(a.q,d)&&(a.k[c++]=d);b++}a.k.length=c}if(a.g!=a.k.length){for(var e={},c=b=0;b<a.k.length;)d=a.k[b],Fb(e,d)||(a.k[c++]=d,e[d]=1),b++;a.k.length=c}}v.get=function(a,b){return Fb(this.q,a)?this.q[a]:b};v.set=function(a,b){Fb(this.q,a)||(this.g++,this.k.push(a),this.ac++);this.q[a]=b};v.gd=function(a){var b;a instanceof Db?(b=a.Lb(),a=a.ba()):(b=gb(a),a=fb(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};v.d=function(){return new Db(this)};
v.tb=function(a){Eb(this);var b=0,c=this.k,d=this.q,e=this.ac,f=this,h=new Ab;h.next=function(){for(;;){e!=f.ac&&g(Error("The map has changed since the iterator was created"));b>=c.length&&g(zb);var h=c[b++];return a?h:d[h]}};return h};function Fb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Hb(a){this.q=new Db;a&&this.gd(a)}function Ib(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+oa(a):b.substr(0,1)+a}v=Hb.prototype;v.aa=function(){return this.q.aa()};v.add=function(a){this.q.set(Ib(a),a)};v.gd=function(a){for(var a=tb(a),b=a.length,c=0;c<b;c++)this.add(a[c])};v.Cc=function(a){for(var a=tb(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};v.remove=function(a){return this.q.remove(Ib(a))};v.clear=function(){this.q.clear()};
v.contains=function(a){a=Ib(a);return Fb(this.q.q,a)};v.ze=function(a){for(var b=new Hb,a=tb(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};v.ba=function(){return this.q.ba()};v.d=function(){return new Hb(this)};v.Hb=function(a){return this.aa()==sb(a)&&Jb(this,a)};
function Jb(a,b){var c=sb(b);if(a.aa()>c)return s;!(b instanceof Hb)&&5<c&&(b=new Hb(b));return yb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.ld)a=b.ld(a);else if(la(b)||A(b))a=0<=jb(b,a);else a:{for(var c in b)if(b[c]==a){a=p;break a}a=s}return a})}v.tb=function(){return this.q.tb(s)};function Kb(){}Kb.prototype.ne=s;Kb.prototype.$=function(){this.ne||(this.ne=p,this.t())};Kb.prototype.t=function(){this.zf&&Lb.apply(r,this.zf)};function Mb(a){a&&"function"==typeof a.$&&a.$()}function Lb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];la(d)?Lb.apply(r,d):Mb(d)}};function Nb(a,b){this.Fe=b;this.Kb=[];a>this.Fe&&g(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.Kb.push(this.pc())}D(Nb,Kb);v=Nb.prototype;v.ke=r;v.me=r;function Ob(a,b){a.Kb.length<a.Fe?a.Kb.push(b):a.qd(b)}v.pc=function(){return this.ke?this.ke():{}};v.qd=function(a){if(this.me)this.me(a);else if(na(a))if(ma(a.$))a.$();else for(var b in a)delete a[b]};v.t=function(){Nb.C.t.call(this);for(var a=this.Kb;a.length;)this.qd(a.pop());delete this.Kb};function Pb(){this.Ib=[];this.Gd=new Db;this.cf=this.df=this.ef=this.Ye=0;this.Zb=new Db;this.he=this.bf=0;this.Dd=1;this.rd=new Nb(0,4E3);this.rd.pc=function(){return new Qb};this.Ze=new Nb(0,50);this.Ze.pc=function(){return new Rb};var a=this;this.ud=new Nb(0,2E3);this.ud.pc=function(){return""+a.Dd++};this.ud.qd=aa()}function Rb(){this.Qd=this.time=this.count=0}
Rb.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.Qd&&a.push(" [VarAlloc = ",this.Qd,"]");return a.join("")};function Qb(){}function Sb(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(Tb(a.oe-c));e.push(" ",Ub(a.oe-b));0==a.sd?e.push(" Start        "):1==a.sd?(e.push(" Done "),e.push(Tb(a.th-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.Ng&&e.push("[VarAlloc ",a.Ng,"] ");return e.join("")}
Qb.prototype.toString=function(){return this.type==r?this.xf:"["+this.type+"] "+this.xf};Pb.prototype.reset=function(){for(var a=0;a<this.Ib.length;a++){var b=this.rd.id;b&&Ob(this.ud,b);Ob(this.rd,this.Ib[a])}this.Ib.length=0;this.Gd.clear();this.Ye=va();this.he=this.bf=this.cf=this.df=this.ef=0;b=this.Zb.Lb();for(a=0;a<b.length;a++){var c=this.Zb.get(b[a]);c.count=0;c.time=0;c.Qd=0;Ob(this.Ze,c)}this.Zb.clear()};
Pb.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.Ib.length;d++){var e=this.Ib[d];1==e.sd&&c.pop();a.push(" ",Sb(e,this.Ye,b,c.join("")));b=e.oe;a.push("\n");0==e.sd&&c.push("|  ")}if(0!=this.Gd.aa()){var f=va();a.push(" Unstopped timers:\n");Cb(this.Gd,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",Ub(b.startTime),")\n")})}b=this.Zb.Lb();for(d=0;d<b.length;d++)c=this.Zb.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.bf,"\n","Total comments created ",
this.he,"\n","Overhead start: ",this.ef," ms\n","Overhead end: ",this.df," ms\n","Overhead comment: ",this.cf," ms\n");return a.join("")};function Tb(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function Ub(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new Pb;function Vb(){}var Xb=0;v=Vb.prototype;v.key=0;v.pb=s;v.hd=s;v.oa=function(a,b,c,d,e,f){ma(a)?this.Ae=p:a&&a.handleEvent&&ma(a.handleEvent)?this.Ae=s:g(Error("Invalid listener argument"));this.Qb=a;this.Se=b;this.src=c;this.type=d;this.capture=!!e;this.td=f;this.hd=s;this.key=++Xb;this.pb=s};v.handleEvent=function(a){return this.Ae?this.Qb.call(this.td||this.src,a):this.Qb.handleEvent.call(this.Qb,a)};!F||db(9);var Yb=!F||db(9),ac=F&&!H("8");!G||H("528");Pa&&H("1.9b")||F&&H("8")||Oa&&H("9.5")||G&&H("528");!Pa||H("8");function bc(a,b){this.type=a;this.currentTarget=this.target=b}D(bc,Kb);v=bc.prototype;v.t=function(){delete this.type;delete this.target;delete this.currentTarget};v.Za=s;v.Xb=p;v.stopPropagation=function(){this.Za=p};v.preventDefault=function(){this.Xb=s};function cc(a){cc[" "](a);return a}cc[" "]=da;function dc(a,b){a&&this.oa(a,b)}D(dc,bc);v=dc.prototype;v.target=r;v.relatedTarget=r;v.offsetX=0;v.offsetY=0;v.clientX=0;v.clientY=0;v.screenX=0;v.screenY=0;v.button=0;v.keyCode=0;v.charCode=0;v.ctrlKey=s;v.altKey=s;v.shiftKey=s;v.metaKey=s;v.ia=r;
v.oa=function(a,b){var c=this.type=a.type;bc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Pa){var e;a:{try{cc(d.nodeName);e=p;break a}catch(f){}e=s}e||(d=r)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=G||a.offsetX!==n?a.offsetX:a.layerX;this.offsetY=G||a.offsetY!==n?a.offsetY:a.layerY;this.clientX=a.clientX!==n?a.clientX:a.pageX;this.clientY=a.clientY!==n?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.ia=a;delete this.Xb;delete this.Za};v.stopPropagation=function(){dc.C.stopPropagation.call(this);this.ia.stopPropagation?this.ia.stopPropagation():this.ia.cancelBubble=p};
v.preventDefault=function(){dc.C.preventDefault.call(this);var a=this.ia;if(a.preventDefault)a.preventDefault();else if(a.returnValue=s,ac)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};v.If=t("ia");v.t=function(){dc.C.t.call(this);this.relatedTarget=this.currentTarget=this.target=this.ia=r};var ec={},fc={},gc={},hc={};
function L(a,b,c,d,e){if(b){if(ka(b)){for(var f=0;f<b.length;f++)L(a,b[f],c,d,e);return r}var d=!!d,h=fc;b in h||(h[b]={g:0,V:0});h=h[b];d in h||(h[d]={g:0,V:0},h.g++);var h=h[d],i=oa(a),k;h.V++;if(h[i]){k=h[i];for(f=0;f<k.length;f++)if(h=k[f],h.Qb==c&&h.td==e){if(h.pb)break;return k[f].key}}else k=h[i]=[],h.g++;f=ic();f.src=a;h=new Vb;h.oa(c,f,a,b,d,e);c=h.key;f.key=c;k.push(h);ec[c]=h;gc[i]||(gc[i]=[]);gc[i].push(h);a.addEventListener?(a==x||!a.le)&&a.addEventListener(b,f,d):a.attachEvent(b in hc?
hc[b]:hc[b]="on"+b,f);return c}g(Error("Invalid event type"))}function ic(){var a=jc,b=Yb?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function kc(a,b,c,d,e){if(ka(b))for(var f=0;f<b.length;f++)kc(a,b[f],c,d,e);else a=L(a,b,c,d,e),ec[a].hd=p}
function lc(a,b,c,d,e){if(ka(b))for(var f=0;f<b.length;f++)lc(a,b[f],c,d,e);else{d=!!d;a:{f=fc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=oa(a),f[a]))){a=f[a];break a}a=r}if(a)for(f=0;f<a.length;f++)if(a[f].Qb==c&&a[f].capture==d&&a[f].td==e){mc(a[f].key);break}}}
function mc(a){if(!ec[a])return s;var b=ec[a];if(b.pb)return s;var c=b.src,d=b.type,e=b.Se,f=b.capture;c.removeEventListener?(c==x||!c.le)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in hc?hc[d]:hc[d]="on"+d,e);c=oa(c);e=fc[d][f][c];if(gc[c]){var h=gc[c];ob(h,b);0==h.length&&delete gc[c]}b.pb=p;e.Je=p;nc(d,f,c,e);delete ec[a];return p}
function nc(a,b,c,d){if(!d.xc&&d.Je){for(var e=0,f=0;e<d.length;e++)d[e].pb?d[e].Se.src=r:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Je=s;0==f&&(delete fc[a][b][c],fc[a][b].g--,0==fc[a][b].g&&(delete fc[a][b],fc[a].g--),0==fc[a].g&&delete fc[a])}}function oc(a){var b,c=0,d=b==r;b=!!b;if(a==r)eb(gc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)mc(f.key),c++}});else if(a=oa(a),gc[a])for(var a=gc[a],e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)mc(f.key),c++}}
function pc(a){var b=qc,a=oa(a),c=gc[a];if(c){var d=ja(b),e=ja(n);return d&&e?(c=fc[b],!!c&&!!c[n]&&a in c[n]):!d&&!e?p:mb(c,function(a){return d&&a.type==b||e&&a.capture==n})}return s}function rc(a,b,c,d,e){var f=1,b=oa(b);if(a[b]){a.V--;a=a[b];a.xc?a.xc++:a.xc=1;try{for(var h=a.length,i=0;i<h;i++){var k=a[i];k&&!k.pb&&(f&=sc(k,e)!==s)}}finally{a.xc--,nc(c,d,b,a)}}return Boolean(f)}function sc(a,b){var c=a.handleEvent(b);a.hd&&mc(a.key);return c}
function jc(a,b){if(!ec[a])return p;var c=ec[a],d=c.type,e=fc;if(!(d in e))return p;var e=e[d],f,h;if(!Yb){var i;if(!(i=b))a:{i=["window","event"];for(var k=x;f=i.shift();)if(y(k[f]))k=k[f];else{i=r;break a}i=k}f=i;i=p in e;k=s in e;if(i){if(0>f.keyCode||f.returnValue!=n)return p;a:{var o=s;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(q){o=p}if(o||f.returnValue==n)f.returnValue=p}}o=new dc;o.oa(f,this);f=p;try{if(i){for(var l=[],m=o.currentTarget;m;m=m.parentNode)l.push(m);h=e[p];h.V=h.g;for(var j=
l.length-1;!o.Za&&0<=j&&h.V;j--)o.currentTarget=l[j],f&=rc(h,l[j],d,p,o);if(k){h=e[s];h.V=h.g;for(j=0;!o.Za&&j<l.length&&h.V;j++)o.currentTarget=l[j],f&=rc(h,l[j],d,s,o)}}else f=sc(c,o)}finally{l&&(l.length=0),o.$()}return f}d=new dc(b,this);try{f=sc(c,d)}finally{d.$()}return f}var tc=0;function uc(a){return a+"_"+tc++};function M(a){bc.call(this,a);this._className="event"}D(M,bc);var vc=uc("pan"),wc=uc("rotate"),xc=uc("zoom"),yc=uc("render"),zc=uc("resetview"),qc=uc("modified"),Ac=uc("progress"),Bc=uc("hover"),Cc=uc("hover_end");function Dc(){M.call(this,vc);this.bb=new Ec(0,0)}D(Dc,M);function Fc(){M.call(this,wc);this.bb=new Ec(0,0)}D(Fc,M);function Gc(){M.call(this,xc);this.wa=this.Ra=s}D(Gc,M);function Hc(){M.call(this,yc)}D(Hc,M);function Ic(){M.call(this,Bc);this.oc=this.nc=0}D(Ic,M);
function Jc(){M.call(this,Cc)}D(Jc,M);function Kc(){M.call(this,zc)}D(Kc,M);function Lc(){M.call(this,qc);this.Fa=new N}D(Lc,M);function Mc(){M.call(this,Ac);this.ee=0}D(Mc,M);function Nc(a,b,c){this.x=ja(a)?a:0;this.y=ja(b)?b:0;this.b=ja(c)?c:0}Nc.prototype.d=function(){return new Nc(this.x,this.y,this.b)};Nc.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.b+")"};Nc.prototype.af=function(){return[this.x,this.y,this.b]};function O(a,b,c){this.x=a;this.y=b;this.b=c}D(O,Nc);v=O.prototype;v.d=function(){return new O(this.x,this.y,this.b)};v.Ya=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};v.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};v.A=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};v.normalize=function(){return this.scale(1/this.Ya())};v.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
v.sa=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};v.Hb=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Oc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Pc(a,b){return new O(a.x+b.x,a.y+b.y,a.b+b.b)}function Qc(a,b){return new O(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Rc(){}D(Rc,Kb);v=Rc.prototype;v.le=p;v.yc=r;v.Kd=ca("yc");v.addEventListener=function(a,b,c,d){L(this,a,b,c,d)};v.removeEventListener=function(a,b,c,d){lc(this,a,b,c,d)};
v.dispatchEvent=function(a){var b=a.type||a,c=fc;if(b in c){if(A(a))a=new bc(a,this);else if(a instanceof bc)a.target=a.target||this;else{var d=a,a=new bc(b,this);ib(a,d)}var d=1,e,c=c[b],b=p in c,f;if(b){e=[];for(f=this;f;f=f.yc)e.push(f);f=c[p];f.V=f.g;for(var h=e.length-1;!a.Za&&0<=h&&f.V;h--)a.currentTarget=e[h],d&=rc(f,e[h],a.type,p,a)&&a.Xb!=s}if(s in c)if(f=c[s],f.V=f.g,b)for(h=0;!a.Za&&h<e.length&&f.V;h++)a.currentTarget=e[h],d&=rc(f,e[h],a.type,s,a)&&a.Xb!=s;else for(e=this;!a.Za&&e&&f.V;e=
e.yc)a.currentTarget=e,d&=rc(f,e,a.type,s,a)&&a.Xb!=s;a=Boolean(d)}else a=p;return a};v.t=function(){Rc.C.t.call(this);oc(this);this.yc=r};function P(){this._className="base";this.c=s}D(P,Rc);P.prototype.className=t("_className");P.prototype.print=function(){var a=Object.keys(this),b="",c="<unknown>",d=0;for(d in a){var e="this."+a[d],f=eval(e);"this._className"==e?c=f:b+=e+": "+f+"\n"}return"== X."+c+" ==\n"+b};P.prototype.Bf=t("c");function Sc(a){a.c=s}C("X.base",P);C("X.base.prototype.className",P.prototype.className);C("X.base.prototype.print",P.prototype.print);C("X.base.prototype.dirty",P.prototype.Bf);function Q(a){P.call(this);this._className="triplets";this.Ba=this.Ea=this.Aa=this.Da=this.za=this.Ca=r;this.cc=[0,0,0];this.U=[];y(a)&&a instanceof Q&&(this.U=a.all().slice(),this.Ca=a.Ca,this.za=a.za,this.Da=a.Da,this.Aa=a.Aa,this.Ea=a.Ea,this.Ba=a.Ba,this.cc=a.cc.slice())}D(Q,P);v=Q.prototype;
v.add=function(a,b,c){(!B(a)||!B(b)||!B(c))&&g(Error("Invalid triplet."));if(!this.Ca||a<this.Ca)this.Ca=a;if(!this.za||a>this.za)this.za=a;if(!this.Da||b<this.Da)this.Da=b;if(!this.Aa||b>this.Aa)this.Aa=b;if(!this.Ea||c<this.Ea)this.Ea=c;if(!this.Ba||c>this.Ba)this.Ba=c;this.cc=[(this.Ca+this.za)/2,(this.Da+this.Aa)/2,(this.Ea+this.Ba)/2];this.c=p;return this.U.push(a,b,c)/3};v.get=function(a){(!B(a)||3*a>this.U.length)&&g(Error("Invalid id."));a*=3;return[this.U[a],this.U[a+1],this.U[a+2]]};
v.remove=function(a){(!B(a)||3*a>this.U.length)&&g(Error("Invalid id."));this.U.splice(a,3);this.c=p};v.all=t("U");v.clear=function(){this.U=[];this.c=p};v.count=function(){return this.U.length/3};v.length=function(){return this.U.length};C("X.triplets",Q);C("X.triplets.prototype.add",Q.prototype.add);C("X.triplets.prototype.get",Q.prototype.get);C("X.triplets.prototype.remove",Q.prototype.remove);C("X.triplets.prototype.all",Q.prototype.all);C("X.triplets.prototype.clear",Q.prototype.clear);
C("X.triplets.prototype.count",Q.prototype.count);C("X.triplets.prototype.length",Q.prototype.length);function Tc(){P.call(this);this._className="parser"}D(Tc,P);v=Tc.prototype;v.parse=function(){g(Error("The function parse() should be overloaded."))};v.Vb=function(a,b){var c=this.r(a,b+2),d=this.r(a,b+3),e=(d<<1&255|c>>7)-127,c=(c&127)<<16|this.r(a,b+1)<<8|this.r(a,b);return 0==c&&-127==e?0:(1-2*(d>>7))*(1+c*Math.pow(2,-23))*Math.pow(2,e)};
function Uc(a,b,c){var d=a.r(b,c),e=a.r(b,c+1),f=(d<<1&255|e>>7)-127,a=(e&127)<<16|a.r(b,c+2)<<8|a.r(b,c+3);return 0==a&&-127==f?0:(1-2*(d>>7))*(1+a*Math.pow(2,-23))*Math.pow(2,f)}function Vc(a,b,c,d){var e=[],f=0,h=Infinity,i;for(i=0;i<d;i++){var k=a.Vb(b,c+4*i);e[i]=k;f=Math.max(f,k);h=Math.min(h,k)}return[e,f,h]}function Wc(a,b,c){return(a.r(b,c+3)<<24)+(a.r(b,c+2)<<16)+(a.r(b,c+1)<<8)+a.r(b,c)}function Xc(a,b,c){return(a.r(b,c)<<24)+(a.r(b,c+1)<<16)+(a.r(b,c+2)<<8)+a.r(b,c+3)}
v.Bc=function(a,b){return(this.r(a,b+1)<<8)+this.r(a,b)};v.pg=function(a,b){var c=this.r(a,b);return 127<c?c-256:c};v.r=function(a,b){return a.charCodeAt(b)&255};function Yc(){Tc.call(this);this._className="parserTRK"}D(Yc,Tc);
Yc.prototype.parse=function(a,b){var c=a.i,d=a.n,e=a.X,f=0,h=f+6,i=0,k=Infinity,o;for(o=0;3>o;o++)var q=this.Bc(b,h+2*o),i=Math.max(i,q),k=Math.min(k,q);var l=Vc(this,b,f+12,3)[0];Vc(this,b,f+24,3);var m=this.Bc(b,f+36),j=this.Bc(b,f+238);Vc(this,b,f+440,16);Vc(this,b,f+956,6);for(var h=Wc(this,b,f+988),f=Wc(this,b,f+996),i=[],u=r,w=r,z=r,E=r,S=q=r,k=0;k<h;k++){var K=Wc(this,b,f),I=new Q,f=f+4;for(o=0;o<K;o++){var ea=this.Vb(b,f),f=f+4,ba=this.Vb(b,f),f=f+4,fa=this.Vb(b,f),f=f+4;0<m&&(Vc(this,b,f,
m),f+=4*m);ea/=l[0];ba/=l[1];fa/=l[2];I.add(ea,ba,fa)}0<j&&(f+=4*j);o=I.Ca;var K=I.za,ea=I.Da,ba=I.Aa,fa=I.Ea,Wb=I.Ba;if(!u||o<u)u=o;if(!w||K>w)w=K;if(!z||ea<z)z=ea;if(!E||ba>E)E=ba;if(!q||fa<q)q=fa;if(!S||Wb>S)S=Wb;i.push(I)}f=(u+w)/2;z=(z+E)/2;q=(q+S)/2;for(k=0;k<h;k++){S=i[k];E=S.count();for(o=0;o<E-1;o++)m=S.get(o),l=S.get(o+1),c.add(m[0],m[1],m[2]),c.add(l[0],l[1],l[2]),j=m[0]-f,u=m[1]-z,w=m[2]-q,I=Math.sqrt(j*j+u*u+w*w),K=l[0]-f,ea=l[1]-z,ba=l[2]-q,fa=Math.sqrt(K*K+ea*ea+ba*ba),d.add(j/I,u/
I,w/I),d.add(K/fa,ea/fa,ba/fa),l=[Math.abs(l[0]-m[0]),Math.abs(l[1]-m[1]),Math.abs(l[2]-m[2])],m=Math.sqrt(l[0]*l[0]+l[1]*l[1]+l[2]*l[2]),l[0]/=m,l[1]/=m,l[2]/=m,e.add(l[0],l[1],l[2]),e.add(l[0],l[1],l[2])}a.rb(Zc);c=new Lc;c.Fa=a;this.dispatchEvent(c)};C("X.parserTRK",Yc);C("X.parserTRK.prototype.parse",Yc.prototype.parse);function $c(){Tc.call(this);this._className="parserSTL"}D($c,Tc);$c.prototype.parse=function(a,b){for(var c=b.split("\n"),d=c.length,e=a.i,f=a.n,h=0,i=d%8;i--;)this.w(e,f,c[h]),h++;for(i=0.125*d^0;i--;)this.w(e,f,c[h]),h++,this.w(e,f,c[h]),h++,this.w(e,f,c[h]),h++,this.w(e,f,c[h]),h++,this.w(e,f,c[h]),h++,this.w(e,f,c[h]),h++,this.w(e,f,c[h]),h++,this.w(e,f,c[h]),h++;c=new Lc;c.Fa=a;this.dispatchEvent(c)};
$c.prototype.w=function(a,b,c){var c=c.replace(/^\s+|\s+$/g,""),d=c.split(" ");if("vertex"==d[0]){var c=parseFloat(d[1]),e=parseFloat(d[2]),d=parseFloat(d[3]);a.add(c,e,d)}else"facet"==d[0]&&(c=parseFloat(d[2]),e=parseFloat(d[3]),d=parseFloat(d[4]),b.add(c,e,d),b.add(c,e,d),b.add(c,e,d))};C("X.parserSTL",$c);C("X.parserSTL.prototype.parse",$c.prototype.parse);function R(a,b,c){this.R=this.Q=this.P=0;3==arguments.length?(this.P=Number(a),this.Q=Number(b),this.R=Number(c)):"x"in a&&"y"in a&&"z"in a?(this.P=Number(a.x()),this.Q=Number(a.y()),this.R=Number(a.b())):(this.P=Number(a[0]),this.Q=Number(a[1]),this.R=Number(a[2]))}
R.prototype={d:function(){return new R(this.P,this.Q,this.R)},Cd:function(){return new R(-this.P,-this.Q,-this.R)},nb:function(a){return new R(this.P+a.x(),this.Q+a.y(),this.R+a.b())},Sb:function(a){return new R(this.P-a.x(),this.Q-a.y(),this.R-a.b())},Ma:function(a){return new R(this.P*a,this.Q*a,this.R*a)},Cf:function(a){return new R(this.P/a,this.Q/a,this.R/a)},kb:function(a){return this.P*a.x()+this.Q*a.y()+this.R*a.b()},Ce:function(a,b){return this.nb(a.Sb(this).Ma(b))},length:function(){return Math.sqrt(this.kb(this))},
$b:function(){return this.Cf(this.length())},nd:function(a){return new R(this.Q*a.b()-this.R*a.y(),this.R*a.x()-this.P*a.b(),this.P*a.y()-this.Q*a.x())},x:t("P"),y:t("Q"),b:t("R")};function ad(){this.Dc=n}
function bd(a,b,c){switch(typeof b){case "string":cd(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(b==r){c.push("null");break}if(ka(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),e=b[f],bd(a,a.Dc?a.Dc.call(b,""+f,e):e,c),e=",";c.push("]");break}c.push("{");d="";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(e=b[f],"function"!=typeof e&&(c.push(d),cd(f,c),c.push(":"),
bd(a,a.Dc?a.Dc.call(b,f,e):e,c),d=","));c.push("}");break;case "function":break;default:g(Error("Unknown type: "+typeof b))}}var dd={'"':'\\"',"\\":"\\\\","/":"\\/","\u0008":"\\b","\u000c":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},ed=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;
function cd(a,b){b.push('"',a.replace(ed,function(a){if(a in dd)return dd[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return dd[a]=e+b.toString(16)}),'"')};function fd(){P.call(this);this._className="indexer";this.dd=[];this.Uc={}}D(fd,P);fd.prototype.add=function(a){y(a)||g(Error("Invalid object."));var b;b=[];bd(new ad,a,b);b=b.join("");b in this.Uc||(this.Uc[b]=this.dd.length,this.dd.push(a));return this.Uc[b]};fd.prototype.unique=t("dd");function gd(a,b){this.N=new R(a);this.B=new R(b)}gd.prototype={d:function(){return new gd(this.N.d(),this.B.d())},Wa:function(){this.B=this.B.Cd()},Pf:function(a,b){return new gd(this.N.Ce(a.N,b),this.B.Ce(a.B,b))}};function hd(a,b){this.B=a;this.bc=b}hd.prototype={d:function(){return new hd(this.B.d(),this.bc)},Wa:function(){this.B=this.B.Cd();this.bc=-this.bc}};function id(a,b){this.ta=a;this.Kc=b;var c=a[0].N,d=a[2].N,d=a[1].N.Sb(c).nd(d.Sb(c)).$b();this.M=new hd(d,d.kb(c))}
id.prototype={d:function(){var a=this.ta.map(function(a){return a.d()});return new id(a,this.Kc)},Wa:function(){this.ta.reverse().map(function(a){a.Wa()});this.M.Wa()},Xe:function(a,b,c,d,e){for(var f=0,h=[],i=0;i<this.ta.length;i++){var k=a.B.kb(this.ta[i].N)-a.bc,k=-1.0E-5>k?2:1.0E-5<k?1:0,f=f|k;h.push(k)}switch(f){case 0:(0<a.B.kb(this.M.B)?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(i=0;i<this.ta.length;i++){var o=(i+1)%this.ta.length,k=h[i],
q=h[o],f=this.ta[i],o=this.ta[o];2!=k&&b.push(f);1!=k&&c.push(2!=k?f.d():f);3==(k|q)&&(k=(a.bc-a.B.kb(f.N))/a.B.kb(o.N.Sb(f.N)),k=f.Pf(o,k),b.push(k),c.push(k.d()))}3<=b.length&&d.push(new id(b,this.Kc));3<=c.length&&e.push(new id(c,this.Kc))}}};function jd(a){this.D=this.F=this.M=r;this.l=[];a&&this.hb(a)}
jd.prototype={d:function(){var a=new jd;a.Dg(this.M&&this.M.d());a.Ag(this.F&&this.F.d());a.xg(this.D&&this.D.d());a.Gc(this.l.map(function(a){return a.d()}));return a},A:function(){for(var a=0;a<this.l.length;a++)this.l[a].Wa();this.M.Wa();this.F&&this.F.A();this.D&&this.D.A();a=this.F;this.F=this.D;this.D=a},kd:function(a){if(!this.M)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].Xe(this.M,b,c,b,c);this.F&&(b=this.F.kd(b));c=this.D?this.D.kd(c):[];return b.concat(c)},Z:function(a){this.l=
a.kd(this.l);this.F&&this.F.Z(a);this.D&&this.D.Z(a)},Ja:function(){var a=this.l.slice();this.F&&(a=a.concat(this.F.Ja()));this.D&&(a=a.concat(this.D.Ja()));return a},hb:function(a){if(a.length){this.M||(this.M=a[0].M.d());for(var b=[],c=[],d=0;d<a.length;d++)a[d].Xe(this.M,this.l,this.l,b,c);b.length&&(this.F||(this.F=new jd),this.F.hb(b));c.length&&(this.D||(this.D=new jd),this.D.hb(c))}},Dg:ca("M"),Ag:ca("F"),xg:ca("D"),Gc:ca("l")};function ld(){this.l=[]}function md(a){var b=new ld;b.Gc(a);return b}
ld.prototype={d:function(){var a=new ld;a.Gc(this.l.map(function(a){return a.d()}));return a},Od:function(a){var b=new jd(this.d().l),a=new jd(a.d().l);b.Z(a);a.Z(b);a.A();a.Z(b);a.A();b.hb(a.Ja());return md(b.Ja())},sa:function(a){var b=new jd(this.d().l),a=new jd(a.d().l);b.A();b.Z(a);a.Z(b);a.A();a.Z(b);a.A();b.hb(a.Ja());b.A();return md(b.Ja())},xd:function(a){var b=new jd(this.d().l),a=new jd(a.d().l);b.A();a.Z(b);a.A();b.Z(a);a.Z(b);b.hb(a.Ja());b.A();return md(b.Ja())},inverse:function(){var a=
this.d();a.l.map(function(a){a.Wa()});return a},Gc:ca("l")};function T(a,b){this.x=ja(a)?a:0;this.y=ja(b)?b:0}T.prototype.d=function(){return new T(this.x,this.y)};T.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function nd(a,b){return new T(a.x-b.x,a.y-b.y)};function Ec(a,b){this.x=a;this.y=b}D(Ec,T);v=Ec.prototype;v.d=function(){return new Ec(this.x,this.y)};v.Ya=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};v.scale=function(a){this.x*=a;this.y*=a;return this};v.A=function(){this.x=-this.x;this.y=-this.y;return this};v.normalize=function(){return this.scale(1/this.Ya())};v.add=function(a){this.x+=a.x;this.y+=a.y;return this};v.sa=function(a){this.x-=a.x;this.y-=a.y;return this};
v.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};v.Hb=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function od(a,b){this.width=a;this.height=b}function pd(a,b){return a==b?p:!a||!b?s:a.width==b.width&&a.height==b.height}v=od.prototype;v.d=function(){return new od(this.width,this.height)};v.toString=function(){return"("+this.width+" x "+this.height+")"};v.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};v.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
v.scale=function(a){this.width*=a;this.height*=a;return this};function qd(a,b){if(a instanceof qd)this.v=a.af();else{var c;if(c=la(a))a:{for(var d=c=0;d<a.length;d++){if(!la(a[d])||0<c&&a[d].length!=c){c=s;break a}for(var e=0;e<a[d].length;e++)if(!B(a[d][e])){c=s;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.v=qb(a):a instanceof od?this.v=rd(a.height,a.width):B(a)&&B(b)&&0<a&&0<b?this.v=rd(a,b):g(Error("Invalid argument(s) for Matrix contructor"))}this.o=new od(this.v[0].length,this.v.length)}
function sd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new qd(b)}function td(a,b,c){for(var d=0;d<a.K().height;d++)for(var e=0;e<a.K().width;e++)b.call(c,a.v[d][e],d,e,a)}function ud(a,b){var c=new qd(a.K());td(a,function(d,e,f){c.v[e][f]=b.call(n,d,e,f,a)});return c}function rd(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}v=qd.prototype;
v.add=function(a){pd(this.o,a.K())||g(Error("Matrix summation is only supported on arrays of equal size"));return ud(this,function(b,c,d){return b+a.v[c][d]})};v.Hb=function(a,b){if(this.o.width!=a.o.width||this.o.height!=a.o.height)return s;for(var c=b||0,d=0;d<this.o.height;d++)for(var e=0;e<this.o.width;e++)if(!(Math.abs(this.v[d][e]-a.v[d][e])<=(c||1.0E-6)))return s;return p};v.K=t("o");function U(a,b,c){return!(0<=b&&b<a.o.height&&0<=c&&c<a.o.width)?r:a.v[b][c]}
function V(a,b,c,d){0<=b&&b<a.o.height&&0<=c&&c<a.o.width||g(Error("Index out of bounds when setting matrix value, ("+b+","+c+") in size ("+a.o.height+","+a.o.width+")"));a.v[b][c]=d}v.multiply=function(a){if(a instanceof qd)return this.o.width!=a.K().height&&g(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),vd(this,a);if(B(a))return wd(this,a);g(Error("A matrix can only be multiplied by a number or another matrix."))};
v.sa=function(a){pd(this.o,a.K())||g(Error("Matrix subtraction is only supported on arrays of equal size."));return ud(this,function(b,c,d){return b-a.v[c][d]})};v.af=t("v");v.toString=function(){var a=0;td(this,function(b){b=(""+b).length;b>a&&(a=b)});var b=[];kb(this.v,function(c){b.push("[ ");kb(c,function(c){c=""+c;b.push(Array(a-c.length+1).join(" ")+c+" ")});b.push("]\n")});return b.join("")};
function vd(a,b){var c=new qd(a.o.height,b.K().width);td(c,function(a,e,f){for(var h=a=0;h<this.o.width;h++)a+=U(this,e,h)*U(b,h,f);V(c,e,f,a)},a);return c}function wd(a,b){return ud(a,function(a){return a*b})};function W(a,b){qd.call(this,a,b);this._className="matrix"}D(W,qd);function xd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new W(b)}v=W.prototype;v.z=function(){var a=[],b=this.K();if(0==b.height||0==b.width)return[];var c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(U(this,c,d));return a};
v.translate=function(a){this.o.width!=this.o.height&&g(Error("Can not translate non-square matrix."));var b=this.K(),c=sd(b.height);a instanceof Ec&&3==b.height?(V(c,0,2,a.x),V(c,1,2,a.y)):a instanceof O&&4==b.height?(V(c,0,3,a.x),V(c,1,3,a.y),V(c,2,3,a.b)):g(Error("Translation failed."));return new W(this.multiply(c))};
v.rotate=function(a,b){(4!=this.K().height||this.o.width!=this.o.height)&&g(Error("Only 4x4 matrices can be rotated."));(!y(b)||!(b instanceof O))&&g(Error("Invalid axis vector."));B(a)||g(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=sd(4);V(f,0,0,d+c.x*c.x*(1-d));V(f,0,1,c.x*c.y*(1-d)-c.b*e);V(f,0,2,c.x*c.b*(1-d)+c.y*e);V(f,1,0,c.y*c.x*(1-d)+c.b*e);V(f,1,1,d+c.y*c.y*(1-d));V(f,1,2,c.y*c.b*(1-d)-c.x*e);V(f,2,0,c.b*c.x*(1-d)-c.y*e);V(f,2,1,c.b*c.y*(1-d)+c.x*e);V(f,2,2,
d+c.b*c.b*(1-d));return new W(this.multiply(f))};v.da=function(a){var b=this.K(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof O&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):g(Error("Multiplication by vector failed."));a=this.multiply(new qd(c));return new O(parseFloat(U(a,0,0)),parseFloat(U(a,1,0)),parseFloat(U(a,2,0)))};v.Lg=function(a,b){var c=this.v[a];this.v[a]=this.v[b];this.v[b]=c};
v.Kg=function(a,b){for(var c=this.K(),d=0,d=0;d<c.height;d++){var e=U(this,d,a);e||(e=0);var f=U(this,d,b);f||(f=0);V(this,d,a,f);V(this,d,b,e)}};C("X.matrix",W);C("X.matrix.createIdentityMatrix",xd);C("X.matrix.prototype.flatten",W.prototype.z);C("X.matrix.prototype.translate",W.prototype.translate);C("X.matrix.prototype.rotate",W.prototype.rotate);C("X.matrix.prototype.multiplyByVector",W.prototype.da);C("X.matrix.prototype.swapRows",W.prototype.Lg);C("X.matrix.prototype.swapCols",W.prototype.Kg);function Y(){P.call(this);this._className="transform";this.f=xd(4);this.la=new Float32Array(this.f.z())}D(Y,P);v=Y.prototype;v.tg=function(a){(!B(a)||-360>a||360<a)&&g(Error("Invalid angle."));this.f=this.f.rotate(a*Math.PI/180,new O(0,1,0));this.la=new Float32Array(this.f.z());this.c=p};v.ug=function(a){(!B(a)||-360>a||360<a)&&g(Error("Invalid angle."));this.f=this.f.rotate(a*Math.PI/180,new O(1,0,0));this.la=new Float32Array(this.f.z());this.c=p};
v.vg=function(a){(!B(a)||-360>a||360<a)&&g(Error("Invalid angle."));this.f=this.f.rotate(a*Math.PI/180,new O(0,0,1));this.la=new Float32Array(this.f.z());this.c=p};v.Og=function(a){B(a)||g(Error("Invalid distance."));this.f=this.f.translate(new O(a,0,0));this.la=new Float32Array(this.f.z());this.c=p};v.Pg=function(a){B(a)||g(Error("Invalid distance."));this.f=this.f.translate(new O(0,a,0));this.la=new Float32Array(this.f.z());this.c=p};
v.Qg=function(a){B(a)||g(Error("Invalid distance."));this.f=this.f.translate(new O(0,0,a));this.la=new Float32Array(this.f.z());this.c=p};v.Uf=t("f");v.Ve=function(a){var b=xd(4);y(a)&&a instanceof W&&(b=a);this.f=b;this.la=new Float32Array(this.f.z());this.c=p};function yd(a){return a.la}function zd(a,b,c){var d=U(a.f,b,c);d||(d=0);V(a.f,b,c,-1*d);a.la=new Float32Array(a.f.z());a.c=p}v.Ff=function(){zd(this,0,0)};v.Gf=function(){zd(this,1,1)};v.Hf=function(){zd(this,2,2)};C("X.transform",Y);
C("X.transform.prototype.rotateX",Y.prototype.tg);C("X.transform.prototype.rotateY",Y.prototype.ug);C("X.transform.prototype.rotateZ",Y.prototype.vg);C("X.transform.prototype.translateX",Y.prototype.Og);C("X.transform.prototype.translateY",Y.prototype.Pg);C("X.transform.prototype.translateZ",Y.prototype.Qg);C("X.transform.prototype.matrix",Y.prototype.Uf);C("X.transform.prototype.setMatrix",Y.prototype.Ve);C("X.transform.prototype.flipX",Y.prototype.Ff);C("X.transform.prototype.flipY",Y.prototype.Gf);
C("X.transform.prototype.flipZ",Y.prototype.Hf);function Ad(a){P.call(this);this._className="file";this.nf=a;this.c=p}D(Ad,P);Ad.prototype.path=t("nf");function Bd(){P.call(this);this._className="texture";var a=window["X.Counter"];a.ye();this._id=a.value();this.Cb=this.Sd=this.Pa=r;this.jc=this.kc=0;this.c=p}D(Bd,P);Bd.prototype.id=t("_id");Bd.prototype.file=t("Pa");Bd.prototype.vd=t("Sd");function N(a){P.call(this);this._className="object";var b=window["X.Counter"];b.ye();this._id=b.value();this._type=Cd;this.de=new Y;this._color=[1,1,1];this.i=new Q;this.n=new Q;this.X=new Q;this.Pa=this.Sa=this.T=r;this._opacity=1;this.ab=r;this._visible=p;this._lineWidth=this._pointSize=1;this._caption=r;this._magicMode=s;y(a)&&(this._type=a.type(),this.de.Ve(new W(a.transform().f)),this._color=Array(a.color()),this.i=new Q(a.i),this.n=new Q(a.n),this.X=new Q(a.X),this.T=a.T,this.Sa=a.Sa,a.file()&&
(this.Pa=new Ad((new String(a.file().path())).toString())),this._opacity=a.opacity(),this.ab=a.children(),this._visible=a.Rd(),this._pointSize=a.Hd(),this._lineWidth=a.lineWidth(),a.caption()&&(this._caption=(new String(a.caption())).toString()),this._magicMode=a.Ad(),this.c=p);this.c=p}D(N,P);var Cd="TRIANGLES",Zc="LINES";v=N.prototype;v.id=t("_id");
function Dd(a){for(var b=a.i.count(),c=[],d=0,d=0;d<b;d+=3){var e=a.i.get(d),f=a.i.get(d+1),h=a.i.get(d+2),i=a.n.get(d),k=a.n.get(d+1),o=a.n.get(d+2),q=a._color;0<a.X.length()&&(q=a.X.get(d));var l=[];l.push(new gd(e,i));l.push(new gd(f,k));l.push(new gd(h,o));c.push(new id(l,q))}return md(c)}
function Ed(a,b){(!y(b)||!(b instanceof ld))&&g(Error("Invalid CSG object."));a.i.clear();a.n.clear();a.X.clear();var c=new fd,d=[];lb(b.l,function(a){for(var b=[],h=a.Kc,b=lb(a.ta,function(a){a.color=h;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.kf=lb(c.unique(),function(a){return[a.N.x(),a.N.y(),a.N.b()]});a.jf=lb(c.unique(),function(a){return[a.B.x(),a.B.y(),a.B.b()]});a.hf=lb(c.unique(),function(a){return!a.color?r:[a.color[0],a.color[1],a.color[2]]});lb(d,function(a){var b=
a[0],c=a[1],a=a[2],d=this.kf,k=this.jf,o=this.hf;this.i.add(d[b][0],d[b][1],d[b][2]);this.i.add(d[c][0],d[c][1],d[c][2]);this.i.add(d[a][0],d[a][1],d[a][2]);this.n.add(k[b][0],k[b][1],k[b][2]);this.n.add(k[c][0],k[c][1],k[c][2]);this.n.add(k[a][0],k[a][1],k[a][2]);o[b]&&this.X.add(o[b][0],o[b][1],o[b][2]);o[c]&&this.X.add(o[c][0],o[c][1],o[c][2]);o[a]&&this.X.add(o[a][0],o[a][1],o[a][2])}.bind(a));a.rb(Cd)}v.type=t("_type");v.rb=ca("_type");v.transform=t("de");v.qg=t("i");v.Xf=t("n");v.wf=t("X");
v.color=t("_color");v.Mg=t("T");v.Ic=function(a){if(y(a)){if(A(a)){var b=a,c=a=new Bd;y(b)?(A(b)&&(b=new Ad(b)),c.Pa=b):c.Pa=r}a instanceof Bd||g(Error("Invalid texture."));this.T=a}else this.T=r};v.Ue=function(a,b,c){(!B(a)&&0>a&&1<a||!B(b)&&0>b&&1<b||!B(c)&&0>c&&1<c)&&g(Error("Invalid color."));if(this.Ob())for(var d=this.children(),e=d.length,f=0,f=0;f<e;f++)d[f].Ue(a,b,c);this._color[0]=a;this._color[1]=b;this._color[2]=c;this.c=p};
v.Od=function(a){(!y(a)||!(a instanceof ld)&&!(a instanceof N))&&g(Error("Invalid object."));var b=a;a instanceof N&&(b=Dd(b));a=new N;Ed(a,Dd(this).Od(b));return a};v.sa=function(a){(!y(a)||!(a instanceof ld)&&!(a instanceof N))&&g(Error("Invalid object."));var b=a;a instanceof N&&(b=Dd(b));a=new N;Ed(a,Dd(this).sa(b));return a};v.xd=function(a){(!y(a)||!(a instanceof ld)&&!(a instanceof N))&&g(Error("Invalid object."));var b=a;a instanceof N&&(b=Dd(b));a=new N;Ed(a,Dd(this).xd(b));return a};
v.inverse=function(a){(!y(a)||!(a instanceof ld)&&!(a instanceof N))&&g(Error("Invalid object."));var b=a;a instanceof N&&(b=Dd(b));a=new N;Ed(a,Dd(this).inverse(b));return a};v.opacity=t("_opacity");v.caption=t("_caption");v.yg=function(a){this._caption=a;this.c=p};v.G=function(a){if(this.Ob())for(var b=this.children(),c=b.length,d=0,d=0;d<c;d++)b[d].G(a);this._visible=a;this.c=p};v.Rd=t("_visible");
v.Fc=function(a){(!B(a)||1<a||0>a)&&g(Error("Invalid opacity."));if(this.Ob())for(var b=this.children(),c=b.length,d=0,d=0;d<c;d++)b[d].Fc(a);this._opacity=a;this.c=p};v.load=function(a){this.Pa=y(a)?new Ad(a):r};v.file=t("Pa");v.Tb=function(){var a=new Lc;a.Fa=this;this.dispatchEvent(a)};v.children=function(){this.ab||(this.ab=[]);return this.ab};v.Ob=function(){return!this.ab?s:0<this.ab.length};v.Bg=function(a){B(a)||g(Error("Invalid line width."));this._lineWidth=a;this.c=p};v.lineWidth=t("_lineWidth");
v.Eg=function(a){B(a)||g(Error("Invalid point size."));this._pointSize=a;this.c=p};v.Hd=t("_pointSize");v.Ad=t("_magicMode");v.Cg=function(a){"boolean"!=typeof a&&g(Error("Invalid magicMode setting."));this._magicMode=a};function Fd(a,b){(!y(a)||!y(b)||!(a instanceof N)||!(b instanceof N))&&g(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.opacity()?-1:1==b.opacity()?1:y(a.qc)&&y(b.qc)&&a.qc>b.qc?-1:1}C("X.object",N);C("X.object.prototype.id",N.prototype.id);
C("X.object.prototype.type",N.prototype.type);C("X.object.prototype.transform",N.prototype.transform);C("X.object.prototype.points",N.prototype.qg);C("X.object.prototype.normals",N.prototype.Xf);C("X.object.prototype.texture",N.prototype.Mg);C("X.object.prototype.setTexture",N.prototype.Ic);C("X.object.prototype.colors",N.prototype.wf);C("X.object.prototype.color",N.prototype.color);C("X.object.prototype.setColor",N.prototype.Ue);C("X.object.prototype.opacity",N.prototype.opacity);
C("X.object.prototype.setOpacity",N.prototype.Fc);C("X.object.prototype.lineWidth",N.prototype.lineWidth);C("X.object.prototype.setLineWidth",N.prototype.Bg);C("X.object.prototype.pointSize",N.prototype.Hd);C("X.object.prototype.setPointSize",N.prototype.Eg);C("X.object.prototype.load",N.prototype.load);C("X.object.prototype.file",N.prototype.file);C("X.object.prototype.caption",N.prototype.caption);C("X.object.prototype.visible",N.prototype.Rd);C("X.object.prototype.setCaption",N.prototype.yg);
C("X.object.prototype.setVisible",N.prototype.G);C("X.object.prototype.magicMode",N.prototype.Ad);C("X.object.prototype.setMagicMode",N.prototype.Cg);C("X.object.prototype.intersect",N.prototype.xd);C("X.object.prototype.inverse",N.prototype.inverse);C("X.object.prototype.subtract",N.prototype.sa);C("X.object.prototype.union",N.prototype.Od);C("X.object.prototype.children",N.prototype.children);function Gd(){Tc.call(this);this._className="parserVTK"}D(Gd,Tc);
Gd.prototype.parse=function(a,b){var c=a.i,d=a.n,e=b.split("\n"),f=e.length,h=new Q,i=new Q;this.H=[];this.Y=Cd;this.Yc=this.Ha=this.xa=this.Ia=s;for(var k=0,o=f%8;o--;)this.w(h,i,e[k]),k++;for(o=0.125*f^0;o--;)this.w(h,i,e[k]),k++,this.w(h,i,e[k]),k++,this.w(h,i,e[k]),k++,this.w(h,i,e[k]),k++,this.w(h,i,e[k]),k++,this.w(h,i,e[k]),k++,this.w(h,i,e[k]),k++,this.w(h,i,e[k]),k++;if(this.Y==Cd){e=i.length();k=f=this.H.length;do{var o=this.H[f-k],q=o.length,l;for(l=0;l<q;l++){var m=parseInt(o[l],10),j=
h.get(m);c.add(j[0],j[1],j[2]);m<e?(m=i.get(m),d.add(m[0],m[1],m[2])):(m=new O(j[0],j[1],j[2]),m.normalize(),d.add(m.x,m.y,m.b))}k--}while(0<k)}else if("TRIANGLE_STRIPS"==this.Y){e=i.length();k=f=this.H.length;do{o=this.H[f-k];q=o.length;for(l=0;l<q;l++)m=parseInt(o[l],10),j=h.get(m),c.add(j[0],j[1],j[2]),(0==l||l==q-1)&&c.add(j[0],j[1],j[2]),m<e?(m=i.get(m),d.add(m[0],m[1],m[2]),(0==l||l==q-1)&&d.add(m[0],m[1],m[2])):(m=new O(j[0],j[1],j[2]),m.normalize(),d.add(m.x,m.y,m.b),(0==l||l==q-1)&&d.add(m.x,
m.y,m.b));k--}while(0<k)}else if(this.Y==Zc){e=i.length();k=f=this.H.length;do{o=this.H[f-k];q=o.length;for(l=0;l<q-1;l++){var u=parseInt(o[l],10),m=parseInt(o[l+1],10),w=h.get(u),j=h.get(m);c.add(w[0],w[1],w[2]);c.add(j[0],j[1],j[2]);u<e-1?(j=i.get(u),m=i.get(m),d.add(j[0],j[1],j[2]),d.add(m[0],m[1],m[2])):(m=new O(w[0],w[1],w[2]),m.normalize(),d.add(m.x,m.y,m.b),m=new O(j[0],j[1],j[2]),m.normalize(),d.add(m.x,m.y,m.b))}k--}while(0<k)}else if("POINTS"==this.Y){e=i.length();k=f=this.H.length;do{o=
this.H[f-k];q=o.length;for(l=0;l<q;l++)m=parseInt(o[l],10),j=h.get(m),c.add(j[0],j[1],j[2]),m<e?(m=i.get(m),d.add(m[0],m[1],m[2])):(m=new O(j[0],j[1],j[2]),m.normalize(),d.add(m.x,m.y,m.b));k--}while(0<k)}else if("POLYGONS"==this.Y){e=i.length();k=f=this.H.length;do{o=this.H[f-k];q=o.length;for(l=0;l<q;l++)m=parseInt(o[l],10),j=h.get(m),c.add(j[0],j[1],j[2]),m<e?(m=i.get(m),d.add(m[0],m[1],m[2])):(m=new O(j[0],j[1],j[2]),m.normalize(),d.add(m.x,m.y,m.b));k--}while(0<k)}a.rb(this.Y);c=new Lc;c.Fa=
a;this.dispatchEvent(c)};
Gd.prototype.w=function(a,b,c){var c=c.replace(/^\s+|\s+$/g,""),c=c.split(" "),d=c.length,e=c[0];if("POINTS"==e)this.Ia=p,this.Ha=this.xa=s;else if("VERTICES"==e)this.xa=p,this.Ha=this.Ia=s,a=parseInt(c[1],10),3<=a?this.Y=Cd:1==a?this.Y="POINTS":g(Error("VTK file not supported!")),this.H=[];else if("TRIANGLE_STRIPS"==e)this.xa=p,this.Ha=this.Ia=s,this.Y="TRIANGLE_STRIPS",this.H=[];else if("LINES"==e)this.xa=p,this.Ha=this.Ia=s,this.Y=Zc,this.H=[];else if("POLYGONS"==e)this.xa=p,this.Ha=this.Ia=s,
this.Y="POLYGONS",this.H=[];else if("POINT_DATA"==e)this.Ha=p,this.xa=this.Ia=s;else if(this.Ia)if(1==d||isNaN(parseFloat(e)))this.Ia=s;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),h=parseFloat(c[2]);a.add(e,f,h)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),h=parseFloat(c[5]),a.add(e,f,h));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.add(d,e,c))}else this.xa?1==d||isNaN(parseFloat(e))?this.xa=s:this.H.push(c.slice(1)):this.Ha&&("NORMALS"==e?this.Yc=p:1==d||isNaN(parseFloat(e))?
this.Yc=this.Ha=s:this.Yc&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),h=parseFloat(c[2]),b.add(e,f,h)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),h=parseFloat(c[5]),b.add(e,f,h)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),b.add(d,e,c))))};C("X.parserVTK",Gd);C("X.parserVTK.prototype.parse",Gd.prototype.parse);function Hd(){Tc.call(this);this._className="parserFSM"}D(Hd,Tc);
Hd.prototype.parse=function(a,b){var c=a.i,d=a.n,e=new Q,f;f=3;var h=0,i;do i=this.r(b,f++),h++;while(200>h&&10!=i);f++;var k=Xc(this,b,f);f+=4;h=Xc(this,b,f);f+=4;i=[];for(var o=0,o=0;o<k;o++){var q=Uc(this,b,f);f+=4;var l=Uc(this,b,f);f+=4;var m=Uc(this,b,f);f+=4;i[o]=0;e.add(q,l,m)}k=[];o=[];for(q=0;q<h;q++){var j=Xc(this,b,f);f+=4;m=Xc(this,b,f);f+=4;l=Xc(this,b,f);f+=4;i[j]+=1;i[m]+=1;i[l]+=1;k.push([j,m,l]);o.push(new O(0,0,0))}for(q=0;q<h;q++){var j=k[q][0],m=k[q][1],l=k[q][2],u=e.get(j);f=
e.get(m);var w=e.get(l),u=new O(u[0],u[1],u[2]),w=new O(w[0],w[1],w[2]);f=(new O(f[0],f[1],f[2])).d().sa(u);u=w.d().sa(u);f=Qc(f,u).normalize();o[j]=o[j].add(f);o[m]=o[m].add(f);o[l]=o[l].add(f)}for(q=0;q<h;q++)j=k[q][0],m=k[q][1],l=k[q][2],u=e.get(j),f=e.get(m),w=e.get(l),c.add(u[0],u[1],u[2]),c.add(f[0],f[1],f[2]),c.add(w[0],w[1],w[2]),j=o[j].scale(1/i[j]).normalize(),m=o[m].scale(1/i[m]).normalize(),l=o[l].scale(1/i[l]).normalize(),d.add(j.x,j.y,j.b),d.add(m.x,m.y,m.b),d.add(l.x,l.y,l.b);a.rb(Cd);
c=new Lc;c.Fa=a;this.dispatchEvent(c)};C("X.parserFSM",Hd);C("X.parserFSM.prototype.parse",Hd.prototype.parse);function Id(a){function b(){Zb+=8;return we<kd.length?kd.charCodeAt(we++)&255:-1}function c(){var a;Zb++;a=za&1;za>>=1;0==za&&(za=b(),a=za&1,za=za>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=ba[b]>>8-a);return b}function e(a){ea++;S[K++]=a;j.push(String.fromCharCode(a));32768==K&&(K=0)}function f(){this.La=this.Ka=0;this.wc=r;this.Be=-1}function h(){for(;;){if(ub[ga]>=xe)return-1;if(ye[ub[ga]]==ga)return ub[ga]++;ub[ga]++}}function i(){var a=vb[wb],b;u&&document.write("<br>len:"+
ga+" treepos:"+wb);if(17==ga)return-1;wb++;ga++;b=h();u&&document.write("<br>IsPat "+b);if(0<=b)a.Ka=b,u&&document.write("<br>b0 "+a.Ka);else if(a.Ka=32768,u&&document.write("<br>b0 "+a.Ka),i())return-1;b=h();if(0<=b)a.La=b,u&&document.write("<br>b1 "+a.La),a.wc=r;else if(a.La=32768,u&&document.write("<br>b1 "+a.La),a.wc=vb[wb],a.Be=wb,i())return-1;ga--;return 0}function k(a,b,c){u&&document.write("currentTree "+a+" numval "+b+" lengths "+c+" show 0");vb=a;wb=0;ye=c;xe=b;for(a=0;17>a;a++)ub[a]=0;
ga=0;if(i())return u&&window.console.log("invalid huffman tree\n"),-1;if(u){document.write("<br>Tree: "+vb.length);for(a=0;32>a;a++)document.write("Places["+a+"].b0="+vb[a].Ka+"<br>"),document.write("Places["+a+"].b1="+vb[a].La+"<br>")}return 0}function o(a){for(var b,d,e=0,f=a[e];;)if(b=c(),u&&document.write("b="+b),b){if(!(f.La&32768))return u&&document.write("ret1"),f.La;f=f.wc;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.Ka&32768))return u&&document.write("ret2"),f.Ka;e++;f=
a[e]}}function q(){var a,h,i,l;do{a=c();h=d(2);switch(h){case 0:u&&window.console.log("Stored\n");break;case 1:u&&window.console.log("Fixed Huffman codes\n");break;case 2:u&&window.console.log("Dynamic Huffman codes\n");break;case 3:u&&window.console.log("Reserved block type!!\n");break;default:u&&window.console.log("Unexpected value %d!\n",h)}if(0==h){var m;za=1;m=b();m|=b()<<8;h=b();h|=b()<<8;for((m^~h)&65535&&document.write("BlockLen checksum mismatch\n");m--;)h=b(),e(h)}else if(1==h)for(var j;;)if(j=
ba[d(7)]>>1,23<j?(j=j<<1|c(),199<j?(j-=128,j=j<<1|c()):(j-=48,143<j&&(j+=136))):j+=256,256>j)e(j);else if(256==j)break;else{j-=257;l=d(Wb[j])+fa[j];j=ba[d(5)]>>3;8<xb[j]?(m=d(8),m|=d(xb[j]-8)<<8):m=d(xb[j]);m+=ze[j];for(j=0;j<l;j++)h=S[K-m&32767],e(h)}else if(2==h){var q=Array(320);h=257+d(5);m=1+d(5);i=4+d(4);for(j=0;19>j;j++)q[j]=0;for(j=0;j<i;j++)q[Kf[j]]=d(3);l=ia.length;for(i=0;i<l;i++)ia[i]=new f;if(k(ia,19,q)){K=0;return}if(u){document.write("<br>distanceTree");for(j=0;j<ia.length;j++)document.write("<br>"+
ia[j].Ka+" "+ia[j].La+" "+ia[j].wc+" "+ia[j].Be)}l=h+m;i=0;var w=-1;for(u&&document.write("<br>n="+l+" bits: "+Zb+"<br>");i<l;)if(w++,j=o(ia),u&&document.write("<br>"+w+" i:"+i+" decode: "+j+"    bits "+Zb+"<br>"),16>j)q[i++]=j;else if(16==j){var z;j=3+d(2);if(i+j>l){K=0;return}for(z=i?q[i-1]:0;j--;)q[i++]=z}else{j=17==j?3+d(3):11+d(7);if(i+j>l){K=0;return}for(;j--;)q[i++]=0}l=$b.length;for(i=0;i<l;i++)$b[i]=new f;if(k($b,h,q)){K=0;return}l=$b.length;for(i=0;i<l;i++)ia[i]=new f;j=[];l=q.length;for(i=
h;i<l;i++)j[i-h]=q[i];if(k(ia,m,j)){K=0;return}for(u&&document.write("<br>literalTree");;)if(j=o($b),256<=j){j-=256;if(0==j)break;j--;l=d(Wb[j])+fa[j];j=o(ia);8<xb[j]?(m=d(8),m|=d(xb[j]-8)<<8):m=d(xb[j]);for(m+=ze[j];l--;)h=S[K-m&32767],e(h)}else e(j)}}while(!a);K=0;za=1}function l(){u&&window.console.log("NEXTFILE");j=[];var a=[];I=s;a[0]=b();a[1]=b();u&&window.console.log("type: "+a[0]+" "+a[1]);120==a[0]&&218==a[1]&&(u&&window.console.log("GEONExT-GZIP"),q(),u&&window.console.log(j.join("")),E[z]=
Array(2),E[z][0]=j.join(""),E[z][1]="geonext.gxt",z++);31==a[0]&&139==a[1]&&(u&&window.console.log("GZIP"),m(),u&&window.console.log(j.join("")),E[z]=Array(2),E[z][0]=j.join(""),E[z][1]="file",z++);if(80==a[0]&&75==a[1]&&(I=p,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();u&&window.console.log("ZIP-Version: "+a[1]+" "+a[0]/10+"."+a[0]%10);w=b();w|=b()<<8;u&&window.console.log("gpflags: "+w);a=b();a|=b()<<8;u&&window.console.log("method: "+a);b();b();b();b();var c=b(),c=c|b()<<8,c=c|b()<<16,
c=c|b()<<24,d=b(),d=d|b()<<8,d=d|b()<<16,d=d|b()<<24,e=b(),e=e|b()<<8,e=e|b()<<16,e=e|b()<<24;u&&window.console.log("local CRC: "+c+"\nlocal Size: "+e+"\nlocal CompSize: "+d);c=b();c|=b()<<8;d=b();d|=b()<<8;u&&window.console.log("filelen "+c);e=0;for(Ra=[];c--;){var f=b();"/"==f|":"==f?e=0:e<Ae-1&&(Ra[e++]=String.fromCharCode(f))}u&&window.console.log("nameBuf: "+Ra);Be||(Be=Ra);for(e=0;e<d;)b(),e++;ea=0;8==a&&(q(),u&&window.console.log(j.join("")),E[z]=Array(2),E[z][0]=j.join(""),E[z][1]=Ra.join(""),
z++);m()}}function m(){var a=[],c;w&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b(),u&&window.console.log("CRC:"));I&&l();a[0]=b();if(8!=a[0])u&&window.console.log("Unknown compression method!");else{w=b();u&&w&-32&&window.console.log("Unknown flags set!");b();b();b();b();b();b();if(w&4){a[0]=b();a[2]=b();ga=a[0]+256*a[1];u&&window.console.log("Extra field size: "+ga);for(a=0;a<ga;a++)b()}if(w&8){a=0;for(Ra=[];c=b();){if("7"==
c||":"==c)a=0;a<Ae-1&&(Ra[a++]=c)}u&&window.console.log("original file name: "+Ra)}if(w&16)for(;b(););w&2&&(b(),b());q();b();b();b();b();b();b();b();b();I&&l()}}var j=[],u=s,w,z=0,E=[],S=Array(32768),K=0,I=s,ea,ba=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,
138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,
123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],fa=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Wb=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],ze=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],xb=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Kf=[16,17,18,0,8,7,9,6,
10,5,11,4,12,3,13,2,14,1,15],kd=a,we=0,za=1,Zb=0,Ae=256,Ra=[],Be,$b=Array(288),ia=Array(32),wb=0,vb=r,ga=0,ub=Array(17);ub[0]=0;var ye,xe;Id.prototype.Rg=function(){u&&window.console.log(kd);l();return E}};function Jd(){Tc.call(this);this._className="parserNRRD"}D(Jd,Tc);
Jd.prototype.parse=function(a,b){var c=0,d=b.match(/^([\s\S]*?)\r?\n\r?\n/),c=d[0].length,e,f,h,i,k,o,d=d[1].split(/\r?\n/);for(k=0,o=d.length;k<o;k++)if(e=d[k],e.match(/NRRD\d+/))this.Rf=p;else if(!e.match(/^#/)&&(i=e.match(/(.*):(.*)/)))f=i[1].trim(),e=i[2].trim(),(h=this.Ef[f])?h.call(this,e):this[f]=e;this.Rf||g(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==this.encoding&&"gz"!==this.encoding&&g(Error("Only raw or gz/gzip encoding is allowed"));if(!this.W&&(this.W=[new O(1,0,0),new O(0,
1,0),new O(0,0,1)],this.Md)){d=[];for(i=0;2>=i;i++)d.push(!isNaN(this.Md[i])?this.W[i].scale(this.Md[i]):n)}i=0;i="gzip"==this.encoding||"gz"==this.encoding?(new Id(b.substr(c))).Rg()[0][0]:b.substr(c);k=this.$a[0]*this.$a[1]*this.$a[2];c=Array(k);d=-Infinity;o=Infinity;for(e=0;e<k;e++)f=this.Ac(i,0+e*this.zc),c[e]=f,d=Math.max(d,f),o=Math.min(o,f);a.I=[(new O(this.W[0][0],this.W[0][1],this.W[0][2])).Ya(),(new O(this.W[1][0],this.W[1][1],this.W[1][2])).Ya(),(new O(this.W[2][0],this.W[2][1],this.W[2][2])).Ya()];
a.fa=[this.$a[0],this.$a[1],this.$a[2]];a.Db=[o,d];a.$e(o,d);a.na();k=this.$a;e=d;i=k[2];d=k[1];k=k[0];f=d*k;o=Array(i);for(h=0;h<i;h++){o[h]=Array(d);for(var q=0;q<d;q++)o[h][q]=new Uint8Array(k)}for(q=q=0;q<i;q++){h=c.slice(q*f,(q+1)*f);for(var l=new Uint8Array(4*f),m=0,j=0,u=0,m=0;m<d;m++)for(j=0;j<k;j++){var w=h[u],w=255*(w/e),z=4*u;l[z]=w;l[++z]=w;l[++z]=w;l[++z]=255;o[q][m][j]=w;u++}m=h=new Bd;m.Cb=l;m.c=p;l=h;l.kc=k;l.c=p;l=h;l.jc=d;l.c=p;a.ce.children()[q].Ic(h)}for(m=0;m<d;m++){l=new Uint8Array(4*
i*k);for(q=u=0;q<i;q++)for(j=0;j<k;j++)w=o[q][m][j],z=4*u,l[z]=w,l[++z]=w,l[++z]=w,l[++z]=255,u++;c=h=new Bd;c.Cb=l;c.c=p;c=h;c.kc=k;c.c=p;c=h;c.jc=i;c.c=p;a.be.children()[m].Ic(h)}for(j=0;j<k;j++){l=new Uint8Array(4*i*d);for(q=u=0;q<i;q++)for(m=0;m<d;m++)w=o[q][m][j],z=4*u,l[z]=w,l[++z]=w,l[++z]=w,l[++z]=255,u++;c=h=new Bd;c.Cb=l;c.c=p;c=h;c.kc=d;c.c=p;c=h;c.jc=i;c.c=p;a.ae.children()[j].Ic(h)}c=new Lc;c.Fa=a;this.dispatchEvent(c)};
Jd.prototype.Ef={type:function(a){switch(a){case "unsigned char":case "uint8":this.Ac=this.r;this.zc=1;break;case "signed char":case "int8":this.Ac=this.pg;this.zc=1;break;case "short":case "signed short":case "unsigned short":case "short int":case "int16":this.Ac=this.Bc;this.zc=2;break;case "int":case "int32":break;case "float":this.Ac=this.Vb;this.zc=4;break;default:g(Error("Only short/int/int8/float data is allowed. Found "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=
a},dimension:function(a){return parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.$a=e},"space directions":function(a){var b,c,d;c=a.match(/\(.*?\)/g);return this.W=function(){var a,f,h;h=[];for(a=0,f=c.length;a<f;a++)d=c[a],h.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return h}()},spacings:function(a){var b;b=a.split(/\s+/);var c,
d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.Md=e}};C("X.parserNRRD",Jd);C("X.parserNRRD.prototype.parse",Jd.prototype.parse);function Kd(){P.call(this);this._className="loader";this.ub=r;this.Bb=0}D(Kd,P);function Ld(a){y(a.ub)||(a.ub=new Db);return a.ub}function Md(a){return!y(a.ub)?p:!a.ub.ld(s)}Kd.prototype.Tf=function(a){Nd(this,1.7);setTimeout(function(){Sc(a.T.file());a.Tb();Ld(this).set(a.id(),p)}.bind(this),100)};function Nd(a,b){a.Bb+=b/Ld(a).aa()/3;1<a.Bb&&(a.Bb=1);var c=new Mc;c.ee=a.Bb;a.dispatchEvent(c)}Kd.prototype.Ee=function(){g(Error("Could not get the file."))};
Kd.prototype.Sf=function(a,b){Nd(this,1);setTimeout(function(){var c=b.file().path().split(".").pop().toLowerCase();"stl"==c?(c=new $c,kc(c,qc,this.Ub.bind(this)),c.parse(b,a.response)):"vtk"==c?(c=new Gd,kc(c,qc,this.Ub.bind(this)),c.parse(b,a.response)):"trk"==c?(c=new Yc,kc(c,qc,this.Ub.bind(this)),c.parse(b,a.response)):"fsm"==c?(c=new Hd,kc(c,qc,this.Ub.bind(this)),c.parse(b,a.response)):"nrrd"==c&&(c=new Jd,kc(c,qc,this.Ub.bind(this)),c.parse(b,a.response))}.bind(this),100)};
Kd.prototype.Ub=function(a){Nd(this,1);setTimeout(function(){var b=a.Fa;Sc(b.file());b.Tb();Ld(this).set(b.id(),p)}.bind(this),100)};function Od(){P.call(this);this._className="shader";this.mc="";this.mc="precision mediump float;\n\nattribute vec3 vertexPosition;\nattribute vec3 vertexNormal;\nattribute vec3 vertexColor;\nattribute vec2 vertexTexturePos;\n\nuniform mat4 view;\nuniform mat4 perspective;\nuniform vec3 center;\nuniform mat4 objectTransform;\nuniform bool useObjectColor;\nuniform vec3 objectColor;\nuniform float pointSize;\n\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * vertexNormal;\n  vec3 vertexPosition2 = vertexPosition - center;\n  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n  fragmentTexturePos = vertexTexturePos;\n  if (useObjectColor) {\n    fragmentColor = objectColor;\n  } else {\n    fragmentColor = vertexColor;\n  }\n  gl_PointSize = pointSize;\n  gl_Position = perspective * fVertexPosition;\n}\n";
this.gc="";this.gc="precision mediump float;\n\nuniform bool usePicking;\nuniform bool useTexture;\nuniform sampler2D textureSampler;\nuniform float objectOpacity;\nuniform float volumeLowerThreshold;\nuniform float volumeUpperThreshold;\nuniform float volumeScalarMin;\nuniform float volumeScalarMax;\n\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n if (usePicking) {\n   gl_FragColor = vec4(fragmentColor, 1.0);\n } else if (useTexture) {\n   gl_FragColor = texture2D(textureSampler,   vec2(fragmentTexturePos.s,fragmentTexturePos.t));\n   float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n   float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n   if (gl_FragColor.r < _volumeLowerThreshold ||\n       gl_FragColor.r > _volumeUpperThreshold) {\n     discard;\n   };\n gl_FragColor.a = objectOpacity;\n } else {\n   vec3 nNormal = normalize(fTransformedVertexNormal);\n   vec3 light = vec3(0.0, 0.0, 1.0);\n   vec3 lightDirection = vec3(0,0,-10);\n   lightDirection = normalize(lightDirection);\n   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n   float ambient = 0.3;\n   gl_FragColor = vec4(fragmentColor * ambient +\n                       fragmentColor * diffuse +\n                       vec3(0.2, 0.2, 0.2) * specular,\n                       objectOpacity);\n }\n}\n"}
D(Od,P);var Pd={hh:"vertexPosition",gh:"vertexNormal",fh:"vertexColor",ih:"vertexTexturePos"},Qd={jh:"view",Zg:"perspective",Ug:"center",Yg:"objectTransform",bh:"useObjectColor",Wg:"objectColor",$g:"pointSize",Xg:"objectOpacity",Vg:"normal",dh:"usePicking",eh:"useTexture",ah:"textureSampler",kh:"volumeLowerThreshold",nh:"volumeUpperThreshold",mh:"volumeScalarMin",lh:"volumeScalarMax"};
function Rd(a){var b=Object.keys(Qd);Object.keys(Pd).every(function(a){a=eval("X.shaders.attributes."+a);return-1!=this.mc.search(a)||-1!=this.gc.search(a)}.bind(a))||g(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=eval("X.shaders.uniforms."+a);return-1!=this.mc.search(a)||-1!=this.gc.search(a)}.bind(a))||g(Error("Could not find all uniforms in the shader sources."))}C("X.shaders.attributes",Pd);C("X.shaders.uniforms",Qd);function Sd(a){this.Ua=a||Td}function Td(a,b){return""+a<""+b?-1:""+a>""+b?1:0}v=Sd.prototype;v.O=r;v.Ua=r;v.qa=r;v.pa=r;v.g=0;
v.add=function(a){if(this.O==r)return this.pa=this.qa=this.O=new Ud(a),this.g=1,p;var b=s;Vd(this,function(c){var d=r;if(0<this.Ua(c.value,a)){if(d=c.left,c.left==r){var e=new Ud(a,c);c.left=e;c==this.qa&&(this.qa=e);b=p;Wd(this,c)}}else 0>this.Ua(c.value,a)&&(d=c.right,c.right==r&&(e=new Ud(a,c),c.right=e,c==this.pa&&(this.pa=e),b=p,Wd(this,c)));return d});b&&(this.g+=1);return b};
v.remove=function(a){var b=r;Vd(this,function(c){var d=r;if(0<this.Ua(c.value,a))d=c.left;else if(0>this.Ua(c.value,a))d=c.right;else if(b=c.value,c.left!=r||c.right!=r){var e=r,f;if(c.left!=r){f=Xd(this,c.left);if(f!=c.left){if(f.parent.right=f.left)f.left.parent=f.parent;f.left=c.left;f.left.parent=f;e=f.parent}f.parent=c.parent;f.right=c.right;f.right&&(f.right.parent=f);c==this.pa&&(this.pa=f)}else{f=Yd(this,c.right);if(f!=c.right){if(f.parent.left=f.right)f.right.parent=f.parent;f.right=c.right;
f.right.parent=f;e=f.parent}f.parent=c.parent;f.left=c.left;f.left&&(f.left.parent=f);c==this.qa&&(this.qa=f)}Zd(c)?c.parent.left=f:$d(c)?c.parent.right=f:this.O=f;Wd(this,e?e:f)}else Zd(c)?(c.parent.left=r,c==this.qa&&(this.qa=c.parent),Wd(this,c.parent)):$d(c)?(c.parent.right=r,c==this.pa&&(this.pa=c.parent),Wd(this,c.parent)):this.clear();return d});b&&(this.g=this.O?this.g-1:0);return b};v.clear=function(){this.pa=this.qa=this.O=r;this.g=0};
v.contains=function(a){var b=s;Vd(this,function(c){var d=r;0<this.Ua(c.value,a)?d=c.left:0>this.Ua(c.value,a)?d=c.right:b=p;return d});return b};v.aa=t("g");v.Nb=function(){return Yd(this).value};v.Mb=function(){return Xd(this).value};v.ba=function(){var a=[];ae(this,function(b){a.push(b)});return a};
function ae(a,b){if(a.O){var c,d=c=Yd(a);for(c=c.left?c.left:c;d!=r;)if(d.left!=r&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=d.right!=r&&d.right!=c?d.right:d.parent;c=e}}}function Vd(a,b,c){for(c=c?c:a.O;c&&c!=r;)c=b.call(a,c)}
function Wd(a,b){Vd(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;1<b-e?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&be(this,a.left),ce(this,a)):1<e-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&ce(this,a.right),be(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function be(a,b){Zd(b)?(b.parent.left=b.right,b.right.parent=b.parent):$d(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.O=b.right,a.O.parent=r);var c=b.right;b.right=b.right.left;b.right!=r&&(b.right.parent=b);c.left=b;b.parent=c}function ce(a,b){Zd(b)?(b.parent.left=b.left,b.left.parent=b.parent):$d(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.O=b.left,a.O.parent=r);var c=b.left;b.left=b.left.right;b.left!=r&&(b.left.parent=b);c.right=b;b.parent=c}
function Yd(a,b){if(!b)return a.qa;var c=b;Vd(a,function(a){var b=r;a.left&&(b=c=a.left);return b},b);return c}function Xd(a,b){if(!b)return a.pa;var c=b;Vd(a,function(a){var b=r;a.right&&(b=c=a.right);return b},b);return c}function Ud(a,b){this.value=a;this.parent=b?b:r}Ud.prototype.left=r;Ud.prototype.right=r;Ud.prototype.height=1;function $d(a){return!!a.parent&&a.parent.right==a}function Zd(a){return!!a.parent&&a.parent.left==a};function de(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}de.prototype.d=function(){return new de(this.top,this.right,this.bottom,this.left)};de.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};de.prototype.contains=function(a){return!this||!a?s:a instanceof de?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function ee(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}v=ee.prototype;v.d=function(){return new ee(this.left,this.top,this.width,this.height)};v.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};
v.ze=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,p}return s};v.contains=function(a){return a instanceof ee?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};
v.K=function(){return new od(this.width,this.height)};var fe;function ge(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=rb(arguments,1),e;e=c;for(var f=0,h=0;h<d.length;h++)0<=jb(e,d[h])||(e.push(d[h]),f++);e=f==d.length;a.className=c.join(" ");return e};var he=!F||db(9);!Pa&&!F||F&&db(9)||Pa&&H("1.9.1");F&&H("9");function ie(a){return a?new je(ke(a)):fe||(fe=new je)}function le(a){return A(a)?document.getElementById(a):a}function me(a,b){eb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in ne?a.setAttribute(ne[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var ne={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function oe(a,b,c){return pe(document,arguments)}
function pe(a,b){var c=b[0],d=b[1];if(!he&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',wa(d.name),'"');if(d.type){c.push(' type="',wa(d.type),'"');var e={};ib(e,d);d=e;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(A(d)?c.className=d:ka(d)?ge.apply(r,[c].concat(d)):me(c,d));2<b.length&&qe(a,c,b);return c}
function qe(a,b,c){function d(c){c&&b.appendChild(A(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];la(f)&&!(na(f)&&0<f.nodeType)?kb(re(f)?qb(f):f,d):d(f)}}function se(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function te(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function ue(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function ke(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function re(a){if(a&&"number"==typeof a.length){if(na(a))return"function"==typeof a.item||"string"==typeof a.item;if(ma(a))return"function"==typeof a.item}return s}function je(a){this.u=a||x.document||document}v=je.prototype;
v.sc=ie;v.e=function(a){return A(a)?this.u.getElementById(a):a};v.jb=function(a,b,c){return pe(this.u,arguments)};v.createElement=function(a){return this.u.createElement(a)};v.createTextNode=function(a){return this.u.createTextNode(a)};function ve(a){return"CSS1Compat"==a.u.compatMode}function Ce(a){var b=a.u,a=!G&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new T(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}v.appendChild=function(a,b){a.appendChild(b)};
v.contains=ue;function De(a,b){var c=ke(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,r))?c[b]||c.getPropertyValue(b):""}function Ee(a,b){return a.currentStyle?a.currentStyle[b]:r}function Fe(a,b){return De(a,b)||Ee(a,b)||a.style&&a.style[b]}function Ge(a){a=a?9==a.nodeType?a:ke(a):document;return F&&!db(9)&&!ve(ie(a))?a.body:a.documentElement}
function He(a){var b=a.getBoundingClientRect();F&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function Ie(a){if(F&&!db(8))return a.offsetParent;for(var b=ke(a),c=Fe(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=Fe(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return r}
function Je(a){for(var b=new de(0,Infinity,Infinity,0),c=ie(a),d=c.u.body,e=c.u.documentElement,f=!G&&"CSS1Compat"==c.u.compatMode?c.u.documentElement:c.u.body;a=Ie(a);)if((!F||0!=a.clientWidth)&&(!G||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=Fe(a,"overflow")){var h=Ke(a),i;i=a;if(Pa&&!H("1.9")){var k=parseFloat(De(i,"borderLeftWidth"));if(Le(i))var o=i.offsetWidth-i.clientWidth-k-parseFloat(De(i,"borderRightWidth")),k=k+o;i=new T(k,parseFloat(De(i,"borderTopWidth")))}else i=new T(i.clientLeft,
i.clientTop);h.x+=i.x;h.y+=i.y;b.top=Math.max(b.top,h.y);b.right=Math.min(b.right,h.x+a.clientWidth);b.bottom=Math.min(b.bottom,h.y+a.clientHeight);b.left=Math.max(b.left,h.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.u.parentWindow||c.u.defaultView||window;e=c.document;G&&!H("500")&&!Qa?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new od(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new od(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:r}
function Ke(a){var b,c=ke(a),d=Fe(a,"position"),e=Pa&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new T(0,0),h=Ge(c);if(a==h)return f;if(a.getBoundingClientRect)b=He(a),a=Ce(ie(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(h),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(G&&"fixed"==Fe(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Oa||G&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=Ie(b))&&b!=c.body&&b!=h;)if(f.x-=b.scrollLeft,!Oa||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function Me(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function Ne(a){if("none"!=Fe(a,"display"))return Oe(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=Oe(a);b.display=c;b.position=e;b.visibility=d;return a}function Oe(a){var b=a.offsetWidth,c=a.offsetHeight,d=G&&!b&&!c;return(!ja(b)||d)&&a.getBoundingClientRect?(a=He(a),new od(a.right-a.left,a.bottom-a.top)):new od(b,c)}function Pe(a,b){a.style.display=b?"":"none"}function Le(a){return"rtl"==Fe(a,"direction")}
function Qe(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var Re={thin:2,medium:4,thick:6};function Se(a,b){if("none"==Ee(a,b+"Style"))return 0;var c=Ee(a,b+"Width");return c in Re?Re[c]:Qe(a,c)};function Te(a){this.ca=a;this.k=[]}D(Te,Kb);var Ue=[];function Ve(a,b,c,d,e){ka(c)||(Ue[0]=c,c=Ue);for(var f=0;f<c.length;f++)a.k.push(L(b,c[f],d||a,e||s,a.ca||a))}Te.prototype.Cc=function(){kb(this.k,mc);this.k.length=0};Te.prototype.t=function(){Te.C.t.call(this);this.Cc()};Te.prototype.handleEvent=function(){g(Error("EventHandler.handleEvent not implemented"))};function We(){}(function(a){a.qe=function(){return a.Nf||(a.Nf=new a)}})(We);We.prototype.Dd=0;We.qe();function Xe(a){this.ha=a||ie()}D(Xe,Rc);v=Xe.prototype;v.Mf=We.qe();v.xe=r;v.Xa=s;v.h=r;v.mb=r;v.ib=r;v.Gb=r;v.Tg=s;v.e=t("h");v.Kd=function(a){this.mb&&this.mb!=a&&g(Error("Method not supported"));Xe.C.Kd.call(this,a)};v.sc=t("ha");v.jb=function(){this.h=this.ha.createElement("div")};v.Wb=function(a){this.qb(a)};v.qb=function(a,b){this.Xa&&g(Error("Component already rendered"));this.h||this.jb();a?a.insertBefore(this.h,b||r):this.ha.u.body.appendChild(this.h);(!this.mb||this.mb.Xa)&&this.rc()};
v.rc=function(){this.Xa=p;Ye(this,function(a){!a.Xa&&a.e()&&a.rc()})};v.Jb=function(){Ye(this,function(a){a.Xa&&a.Jb()});this.uc&&this.uc.Cc();this.Xa=s};v.t=function(){Xe.C.t.call(this);this.Xa&&this.Jb();this.uc&&(this.uc.$(),delete this.uc);Ye(this,function(a){a.$()});!this.Tg&&this.h&&se(this.h);this.mb=this.h=this.Gb=this.ib=r};v.Ob=function(){return!!this.ib&&0!=this.ib.length};function Ye(a,b){a.ib&&kb(a.ib,b,n)}
v.removeChild=function(a,b){if(a){var c=A(a)?a:a.xe||(a.xe=":"+(a.Mf.Dd++).toString(36)),a=this.Gb&&c?(c in this.Gb?this.Gb[c]:n)||r:r;if(c&&a){var d=this.Gb;c in d&&delete d[c];ob(this.ib,a);b&&(a.Jb(),a.h&&se(a.h));c=a;c==r&&g(Error("Unable to set parent component"));c.mb=r;Xe.C.Kd.call(c,r)}}a||g(Error("Child is not in parent component"));return a};function Ze(){}D(Ze,Rc);v=Ze.prototype;v.Pd=0;v.Rb=0;v.Bd=100;v.pe=0;v.Nd=1;v.Qf=s;v.Wf=s;v.Jc=function(a){a=$e(this,a);this.Pd!=a&&(this.Pd=a+this.pe>this.Bd?this.Bd-this.pe:a<this.Rb?this.Rb:a,!this.Qf&&!this.Wf&&this.dispatchEvent("change"))};v.tc=function(){return $e(this,this.Pd)};v.Nb=function(){return $e(this,this.Rb)};v.Mb=function(){return $e(this,this.Bd)};function $e(a,b){return a.Nd==r?b:a.Rb+Math.round((b-a.Rb)/a.Nd)*a.Nd};function af(a){this.ha=a||ie();this.ob=new Ze;L(this.ob,"change",this.Jf,s,this)}D(af,Xe);var bf={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};v=af.prototype;v.jb=function(){this.ea=this.sc().jb("div","progress-bar-thumb");var a=bf[this.Oe];this.h=this.sc().jb("div",a,this.ea);cf(this);this.e().setAttribute("aria-valuemin",this.Nb());this.e().setAttribute("aria-valuemax",this.Mb())};
v.rc=function(){af.C.rc.call(this);F&&7>Va&&L(this.e(),"resize",this.Lc,s,this);this.Lc();var a=this.e();a.setAttribute("role","progressbar");a.sh="progressbar";this.e().setAttribute("aria-live","polite")};v.Jb=function(){af.C.Jb.call(this);df(this)};function df(a){F&&7>Va&&lc(a.e(),"resize",a.Lc,s,a)}v.tc=function(){return this.ob.tc()};v.Jc=function(a){this.ob.Jc(a);this.e()&&cf(this)};function cf(a){var b=a.tc();a.e().setAttribute("aria-valuenow",b)}v.Nb=function(){return this.ob.Nb()};v.Mb=function(){return this.ob.Mb()};
v.Oe="horizontal";v.Jf=function(){this.Lc();this.dispatchEvent("change")};v.Lc=function(){if(this.ea){var a=this.Nb(),b=this.Mb(),a=(this.tc()-a)/(b-a),b=Math.round(100*a);"vertical"==this.Oe?F&&7>Va?(this.ea.style.top=0,this.ea.style.height="100%",b=this.ea.offsetHeight,a=Math.round(a*b),this.ea.style.top=b-a+"px",this.ea.style.height=a+"px"):(this.ea.style.top=100-b+"%",this.ea.style.height=b+"%"):this.ea.style.width=b+"%"}};v.t=function(){df(this);af.C.t.call(this);this.ea=r;this.ob.$()};function ef(a,b){y(a)||g(Error("No valid parent element."));y(b)||g(Error("Invalid initial value."));af.call(this);this._className="progressbar";this.Ga=a;this.ec=this.ma=r;this.Oa=[];this.Oa=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.Jc(b);this.wd()}D(ef,af);
ef.prototype.wd=function(){this.Ga.style.position="relative";var a=document.getElementsByTagName("head")[0],b=oe("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Oa[0]),d=document.createTextNode(this.Oa[1]),e=document.createTextNode(this.Oa[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.ma=b;this.Wb(this.Ga);a=this.e();a.style.position="absolute";a.style.top=(this.Ga.clientHeight-5)/2;a.style.left=(this.Ga.clientWidth-100)/2};
function ff(a){var b=a.e().style.top,c=a.e().style.left;se(a.e());var d=new ef(a.Ga,100),e=d.e();e.style.position="absolute";e.style.top=b;e.style.left=c;(e.firstElementChild!=n?e.firstElementChild:te(e.firstChild)).classList.add("progress-bar-thumb-done");a.ec=d}ef.prototype.yd=function(){this.ma&&se(this.ma);this.e()&&se(this.e());this.ec&&se(this.ec.e());this.ec=this.ma=r};function gf(a,b,c){y(a)||g(Error("Invalid GL Buffer."));y(b)||g(Error("Invalid number of items."));y(c)||g(Error("Invalid item size."));P.call(this);this._className="buffer";this.S=a;this.ya=b;this.fb=c}D(gf,P);var hf=x.window;function jf(a,b,c){ma(a)?c&&(a=ta(a,c)):a&&"function"==typeof a.handleEvent?a=ta(a.handleEvent,a):g(Error("Invalid listener argument"));return 2147483647<b?-1:hf.setTimeout(a,b||0)};function kf(a,b,c,d,e,f,h,i){var k,o=c.offsetParent;if(o){var q="HTML"==o.tagName||"BODY"==o.tagName;if(!q||"static"!=Fe(o,"position"))k=Ke(o),q||(k=nd(k,new T(o.scrollLeft,o.scrollTop)))}o=Ke(a);q=Ne(a);o=new ee(o.x,o.y,q.width,q.height);(q=Je(a))&&o.ze(new ee(q.left,q.top,q.right-q.left,q.bottom-q.top));var q=ie(a),l=ie(c);if(q.u!=l.u){var m=q.u.body,l=l.u.parentWindow||l.u.defaultView,j=new T(0,0),u=ke(m)?ke(m).parentWindow||ke(m).defaultView:window,w=m;do{var z;if(u==l)z=Ke(w);else{var E=w;z=
new T;if(1==E.nodeType)if(E.getBoundingClientRect)E=He(E),z.x=E.left,z.y=E.top;else{var S=Ce(ie(E)),E=Ke(E);z.x=E.x-S.x;z.y=E.y-S.y}else{var S=ma(E.If),K=E;E.targetTouches?K=E.targetTouches[0]:S&&E.ia.targetTouches&&(K=E.ia.targetTouches[0]);z.x=K.clientX;z.y=K.clientY}}j.x+=z.x;j.y+=z.y}while(u&&u!=l&&(w=u.frameElement)&&(u=u.parent));m=nd(j,Ke(m));F&&!ve(q)&&(m=nd(m,Ce(q)));o.left+=m.x;o.top+=m.y}a=(b&4&&Le(a)?b^2:b)&-5;b=new T(a&2?o.left+o.width:o.left,a&1?o.top+o.height:o.top);k&&(b=nd(b,k));
e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var I;if(h&&(I=Je(c))&&k)I.top-=k.y,I.right-=k.x,I.bottom-=k.y,I.left-=k.x;return lf(b,c,d,f,I,h,i)}
function lf(a,b,c,d,e,f,h){var a=a.d(),i=0,k=(c&4&&Le(b)?c^2:c)&-5,c=Ne(b),h=h?h.d():c.d();if(d||0!=k)k&2?a.x-=h.width+(d?d.right:0):d&&(a.x+=d.left),k&1?a.y-=h.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){i=a;d=0;if(65==(f&65)&&(i.x<e.left||i.x>=e.right))f&=-2;if(132==(f&132)&&(i.y<e.top||i.y>=e.bottom))f&=-5;i.x<e.left&&f&1&&(i.x=e.left,d|=1);i.x<e.left&&i.x+h.width>e.right&&f&16&&(h.width=Math.max(h.width-(i.x+h.width-e.right),0),d|=4);i.x+h.width>e.right&&f&1&&(i.x=Math.max(e.right-h.width,
e.left),d|=1);f&2&&(d|=(i.x<e.left?16:0)|(i.x+h.width>e.right?32:0));i.y<e.top&&f&4&&(i.y=e.top,d|=2);i.y>=e.top&&i.y+h.height>e.bottom&&f&32&&(h.height=Math.max(h.height-(i.y+h.height-e.bottom),0),d|=8);i.y+h.height>e.bottom&&f&4&&(i.y=Math.max(e.bottom-h.height,e.top),d|=2);f&8&&(d|=(i.y<e.top?64:0)|(i.y+h.height>e.bottom?128:0));i=d}else i=256;if(i&496)return i}f=a;e=Pa&&(Ia||Ua)&&H("1.9");f instanceof T?(a=f.x,f=f.y):(a=f,f=n);b.style.left=Me(a,e);b.style.top=Me(f,e);pd(c,h)||(a=ve(ie(ke(b))),
F&&(!a||!H("8"))?(c=b.style,a?(F?(a=Qe(b,Ee(b,"paddingLeft")),e=Qe(b,Ee(b,"paddingRight")),f=Qe(b,Ee(b,"paddingTop")),d=Qe(b,Ee(b,"paddingBottom")),a=new de(f,e,d,a)):(a=De(b,"paddingLeft"),e=De(b,"paddingRight"),f=De(b,"paddingTop"),d=De(b,"paddingBottom"),a=new de(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),F?(e=Se(b,"borderLeft"),f=Se(b,"borderRight"),d=Se(b,"borderTop"),b=Se(b,"borderBottom"),b=new de(d,f,b,e)):(e=De(b,"borderLeftWidth"),f=De(b,"borderRightWidth"),d=De(b,"borderTopWidth"),
b=De(b,"borderBottomWidth"),b=new de(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=h.width-b.left-a.left-a.right-b.right,c.pixelHeight=h.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=h.width,c.pixelHeight=h.height)):(b=b.style,Pa?b.MozBoxSizing="border-box":G?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(h.width,0)+"px",b.height=Math.max(h.height,0)+"px"));return i};function mf(){}mf.prototype.ka=aa();function nf(a,b){this.element=a;this.je=b}D(nf,mf);nf.prototype.ka=function(a,b,c){kf(this.element,this.je,a,b,n,c)};function of(a,b){this.ca=new Te(this);this.Jd(a||r);b&&this.rb(b)}D(of,Rc);v=of.prototype;v.h=r;v.uf=p;v.fe=r;v.L=s;v.Ig=s;v.zd=-1;v.Lf=s;v.Df=p;v.sb="toggle_display";v.rb=ca("sb");v.e=t("h");v.Jd=function(a){this.L&&g(Error("Can not change this state of the popup while showing."));this.h=a};
v.G=function(a){this.Yb&&this.Yb.stop();this.Pb&&this.Pb.stop();if(a){if(!this.L&&this.Ed()){this.h||g(Error("Caller must call setElement before trying to show the popup"));this.ka();a=ke(this.h);this.Lf&&Ve(this.ca,a,"keydown",this.Yf,p);if(this.uf)if(Ve(this.ca,a,"mousedown",this.Le,p),F){var b;try{b=a.activeElement}catch(c){}for(;b&&"IFRAME"==b.nodeName;){try{var d=b.contentDocument||b.contentWindow.document}catch(e){break}a=d;b=a.activeElement}Ve(this.ca,a,"mousedown",this.Le,p);Ve(this.ca,a,
"deactivate",this.Ke)}else Ve(this.ca,a,"blur",this.Ke);"toggle_display"==this.sb?(this.h.style.visibility="visible",Pe(this.h,p)):"move_offscreen"==this.sb&&this.ka();this.L=p;this.Yb?(kc(this.Yb,"end",this.Ne,s,this),this.Yb.play()):this.Ne()}}else pf(this)};v.ka=da;function pf(a,b){if(!a.L||!a.dispatchEvent({type:"beforehide",target:b}))return s;a.ca&&a.ca.Cc();a.Pb?(kc(a.Pb,"end",ua(a.ie,b),s,a),a.Pb.play()):a.ie(b);return p}
v.ie=function(a){"toggle_display"==this.sb?this.Ig?jf(this.we,0,this):this.we():"move_offscreen"==this.sb&&(this.h.style.left="-200px",this.h.style.top="-200px");this.L=s;this.Fd(a)};v.we=function(){this.h.style.visibility="hidden";Pe(this.h,s)};v.Ed=function(){return this.dispatchEvent("beforeshow")};v.Ne=function(){this.zd=va();this.dispatchEvent("show")};v.Fd=function(a){va();this.dispatchEvent({type:"hide",target:a})};
v.Le=function(a){a=a.target;!ue(this.h,a)&&(!this.fe||ue(this.fe,a))&&!(150>va()-this.zd)&&pf(this,a)};v.Yf=function(a){27==a.keyCode&&pf(this,a.target)&&(a.preventDefault(),a.stopPropagation())};v.Ke=function(a){if(this.Df){var b=ke(this.h);if(F||Oa){if(a=b.activeElement,!a||ue(this.h,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>va()-this.zd||pf(this)}};v.t=function(){of.C.t.call(this);this.ca.$();Mb(this.Yb);Mb(this.Pb);delete this.h;delete this.ca};function qf(a,b){this.md=a instanceof T?a:new T(a,b)}D(qf,mf);qf.prototype.ka=function(a,b,c,d){kf(Ge(a),0,a,b,this.md,c,r,d)};function rf(a,b){this.rg=4;this.Id=b||n;of.call(this,a)}D(rf,of);rf.prototype.Hc=function(a){this.Id=a||n;this.L&&this.ka()};rf.prototype.ka=function(){if(this.Id){var a=!this.L&&"move_offscreen"!=this.sb,b=this.e();a&&(b.style.visibility="hidden",Pe(b,p));this.Id.ka(b,this.rg,this.qh);a&&Pe(b,s)}};function sf(a,b,c){this.ha=c||(a?ie(le(a)):ie());rf.call(this,this.ha.jb("div",{style:"position:absolute;display:none;"}));this.od=new T(1,1);this.Va=new Hb;a&&tf(this,a);if(b!=r)if(a=this.e(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(ke(a).createTextNode(b))}}D(sf,rf);var uf=[];v=sf.prototype;v.J=r;v.className="goog-tooltip";
v.We=500;v.Kf=0;v.sc=t("ha");function tf(a,b){b=le(b);a.Va.add(b);L(b,"mouseover",a.te,s,a);L(b,"mouseout",a.vc,s,a);L(b,"mousemove",a.se,s,a);L(b,"focus",a.re,s,a);L(b,"blur",a.vc,s,a)}v.detach=function(a){if(a)a=le(a),vf(this,a),this.Va.remove(a);else{for(var b=this.Va.ba(),c=0;a=b[c];c++)vf(this,a);this.Va.clear()}};function vf(a,b){lc(b,"mouseover",a.te,s,a);lc(b,"mouseout",a.vc,s,a);lc(b,"mousemove",a.se,s,a);lc(b,"focus",a.re,s,a);lc(b,"blur",a.vc,s,a)}
v.Jd=function(a){var b=this.e();b&&se(b);sf.C.Jd.call(this,a);a&&(b=this.ha.u.body,b.insertBefore(a,b.lastChild))};v.Ed=function(){if(!of.prototype.Ed.call(this))return s;if(this.anchor)for(var a,b=0;a=uf[b];b++)ue(a.e(),this.anchor)||a.G(s);0<=jb(uf,this)||uf.push(this);a=this.e();a.className=this.className;wf(this);L(a,"mouseover",this.ve,s,this);L(a,"mouseout",this.ue,s,this);xf(this);return p};
v.Fd=function(){ob(uf,this);for(var a=this.e(),b,c=0;b=uf[c];c++)b.anchor&&ue(a,b.anchor)&&b.G(s);this.Qe&&yf(this.Qe);lc(a,"mouseover",this.ve,s,this);lc(a,"mouseout",this.ue,s,this);this.anchor=n;if(0==(this.ra?this.L?4:1:this.lb?3:this.L?2:0))this.Ec=s;of.prototype.Fd.call(this)};v.Ie=function(a,b){this.anchor==a&&this.Va.contains(this.anchor)&&(this.Ec||!this.rh?(this.G(s),this.L||(this.anchor=a,this.Hc(b||zf(this,0)),this.G(p))):this.anchor=n);this.ra=n};
v.Vf=function(a){this.lb=n;a==this.anchor&&(this.J==r||this.J!=this.e()&&!this.Va.contains(this.J))&&(!this.ge||!this.ge.J)&&this.G(s)};function Af(a,b){var c=Ce(a.ha);a.od.x=b.clientX+c.x;a.od.y=b.clientY+c.y}v.te=function(a){var b=Bf(this,a.target);this.J=b;wf(this);b!=this.anchor&&(this.anchor=b,this.ra||(this.ra=jf(ta(this.Ie,this,b,n),this.We)),Cf(this),Af(this,a))};function Bf(a,b){try{for(;b&&!a.Va.contains(b);)b=b.parentNode;return b}catch(c){return r}}
v.se=function(a){Af(this,a);this.Ec=p};v.re=function(a){this.J=a=Bf(this,a.target);this.Ec=p;if(this.anchor!=a){this.anchor=a;var b=zf(this,1);wf(this);this.ra||(this.ra=jf(ta(this.Ie,this,a,b),this.We));Cf(this)}};function zf(a,b){if(0==b){var c=a.od.d();return new Df(c)}return new Ef(a.J)}function Cf(a){if(a.anchor)for(var b,c=0;b=uf[c];c++)ue(b.e(),a.anchor)&&(b.ge=a,a.Qe=b)}
v.vc=function(a){var b=Bf(this,a.target),c=Bf(this,a.relatedTarget);b!=c&&(b==this.J&&(this.J=r),xf(this),this.Ec=s,this.L&&(!a.relatedTarget||!ue(this.e(),a.relatedTarget))?yf(this):this.anchor=n)};v.ve=function(){var a=this.e();this.J!=a&&(wf(this),this.J=a)};v.ue=function(a){var b=this.e();if(this.J==b&&(!a.relatedTarget||!ue(b,a.relatedTarget)))this.J=r,yf(this)};function xf(a){a.ra&&(hf.clearTimeout(a.ra),a.ra=n)}
function yf(a){if(2==(a.ra?a.L?4:1:a.lb?3:a.L?2:0))a.lb=jf(ta(a.Vf,a,a.anchor),a.Kf)}function wf(a){a.lb&&(hf.clearTimeout(a.lb),a.lb=n)}v.t=function(){this.G(s);xf(this);this.detach();this.e()&&se(this.e());this.J=r;delete this.ha;sf.C.t.call(this)};function Df(a,b){qf.call(this,a,b)}D(Df,qf);Df.prototype.ka=function(a,b,c){b=Ge(a);b=Je(b);c=c?new de(c.top+10,c.right,c.bottom,c.left+10):new de(10,0,0,10);lf(this.md,a,4,c,b,9)&496&&lf(this.md,a,4,c,b,5)};function Ef(a){nf.call(this,a,3)}D(Ef,nf);
Ef.prototype.ka=function(a,b,c){var d=new T(10,0);kf(this.element,this.je,a,b,d,c,9)&496&&kf(this.element,2,a,1,d,c,5)};function Ff(a){this.h=a;this.De=L(this.h,Pa?"DOMMouseScroll":"mousewheel",this)}D(Ff,Rc);
Ff.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.ia;if("mousewheel"==a.type){c=1;if(F||G&&(Ja||H("532.0")))c=40;d=G&&Ia&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ja(a.wheelDeltaX)?(b=G&&Ia&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=G&&Ia&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ja(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;B(this.Ge)&&Math.min(Math.max(b,-this.Ge),this.Ge);B(this.He)&&(c=Math.min(Math.max(c,-this.He),
this.He));b=new Gf(d,a,0,c);try{this.dispatchEvent(b)}finally{b.$()}};Ff.prototype.t=function(){Ff.C.t.call(this);mc(this.De);delete this.De};function Gf(a,b,c,d){b&&this.oa(b,n);this.type="mousewheel";this.detail=a;this.pd=d}D(Gf,dc);F||G&&H("525");function Hf(a){(!y(a)||!(a instanceof Element))&&g(Error("Could not add interactor to the given element."));P.call(this);this._className="interactor";this.cb=a;this.Wc=this.Vd=this.Ud=this.Wd=this.Td=this.Xd=r;this.Vc=p;this.rightButtonDown=this.middleButtonDown=this.leftButtonDown=s;this.Rc=new Ec(0,0);this.config={MOUSEWHEEL_ENABLED:p,MOUSECLICKS_ENABLED:p,KEYBOARD_ENABLED:p,HOVERING_ENABLED:p,CONTEXTMENU_ENABLED:s}}D(Hf,P);v=Hf.prototype;
v.oa=function(){this.config.MOUSEWHEEL_ENABLED?(this.Wc=new Ff(this.cb),this.Xd=L(this.Wc,"mousewheel",this.jg.bind(this))):(mc(this.Xd),this.Wc=r);this.config.MOUSEWHEEL_ENABLED?(this.Td=L(this.cb,"mousedown",this.cg.bind(this)),this.Wd=L(this.cb,"mouseup",this.hg.bind(this))):(mc(this.Td),mc(this.Wd));this.cb.oncontextmenu=this.config.CONTEXTMENU_ENABLED?r:function(){return s};window.onkeydown=this.config.KEYBOARD_ENABLED?this.Me.bind(this):r;mc(this.Ud);mc(this.Vd);this.Ud=L(this.cb,"mousemove",
this.eg.bind(this));this.Vd=L(this.cb,"mouseout",this.fg.bind(this))};v.cg=function(a){0==a.button?this.leftButtonDown=p:1==a.button?this.middleButtonDown=p:2==a.button&&(this.rightButtonDown=p);eval("this.onMouseDown(this['leftButtonDown'],this['middleButtonDown'],this['rightButtonDown'])");If(this);a.preventDefault()};v.bg=aa();
v.hg=function(a){0==a.button?this.leftButtonDown=s:1==a.button?this.middleButtonDown=s:2==a.button&&(this.rightButtonDown=s);eval("this.onMouseUp(this['leftButtonDown'],this['middleButtonDown'],this['rightButtonDown'])");If(this);a.preventDefault()};v.gg=aa();v.fg=function(a){this.Vc=s;this.config.KEYBOARD_ENABLED&&(window.onkeydown=r);this.rightButtonDown=this.middleButtonDown=this.leftButtonDown=s;If(this);this.Rc=new Ec(0,0);a.preventDefault()};v.dg=aa();
v.eg=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.Vc=p;this.config.KEYBOARD_ENABLED&&window.onkeydown==r&&(window.onkeydown=this.Me.bind(this));a.preventDefault();var b=a.shiftKey,c=new Ec(a.offsetX,a.offsetY),a=this.Rc.sa(c);this.Rc=c.d();this.config.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.middleButtonDown||this.leftButtonDown||this.rightButtonDown)&&If(this),this.Nc=setTimeout(function(){If(this);var a=new Ic;a.nc=c.x;a.oc=c.y;this.dispatchEvent(a);
this.Nc=r}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.Ya()&&(this.leftButtonDown&&!b?(b=new Fc,b.bb=a,b.oh=0,this.dispatchEvent(b)):this.middleButtonDown||this.leftButtonDown&&b?(b=new Dc,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.bb=a,this.dispatchEvent(b)):this.rightButtonDown&&(b=new Gc,b.Ra=0<a.y,b.wa=s,this.dispatchEvent(b)))};function If(a){a.Nc&&clearTimeout(a.Nc);a.dispatchEvent(new Jc)}v.ig=aa();
v.jg=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");If(this);a.preventDefault();var b=new Gc;y(a.pd)||(a.pd=0);b.Ra=0>a.pd;b.wa=p;this.dispatchEvent(b)};v.$f=aa();
v.Me=function(a){if(this.Vc){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");If(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;if(82==f&&!b&&!c&&!d&&!e)a.preventDefault(),a=new Kc,this.dispatchEvent(a);else if(37<=f&&40>=f&&(a.preventDefault(),a=e?new Dc:b?new Gc:new Fc))c=new Ec(0,0),37==f?(c.x=5,b&&(a.Ra=p,a.wa=s)):39==f?(c.x=-5,b&&(a.Ra=s,a.wa=s)):38==f?(c.y=5,b&&(a.Ra=p,a.wa=p)):40==f&&(c.y=-5,b&&(a.Ra=s,a.wa=p)),a.bb=c,this.dispatchEvent(a)}};C("X.interactor",Hf);
C("X.interactor.prototype.onMouseDown",Hf.prototype.bg);C("X.interactor.prototype.onMouseUp",Hf.prototype.gg);C("X.interactor.prototype.onMouseMove",Hf.prototype.dg);C("X.interactor.prototype.onMouseWheel",Hf.prototype.ig);C("X.interactor.prototype.onKey",Hf.prototype.$f);function Jf(a,b,c,d){y(a)||g(Error("No valid parent element."));(!B(b)||!B(c))&&g(Error("Invalid coordinates."));(!y(d)||!(d instanceof Hf))&&g(Error("Invalid interactor."));sf.call(this);this._className="caption";this.Ga=a;this.nc=b;this.oc=c;this.hc=d;this.ma=r;this.Oa=[];this.Oa=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];kc(d,Cc,this.yd.bind(this));this.wd()}D(Jf,sf);
Jf.prototype.wd=function(){this.Ga.style.position="relative";var a=document.getElementsByTagName("head")[0],b=oe("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Oa[0]);a.appendChild(b);b.appendChild(c);this.ma=b;this.Hc(new qf(this.nc,this.oc));this.G(p);tf(this,this.Ga);this.e().classList.add("x-tooltip")};Jf.prototype.yd=function(){this.G(s);this.ma&&se(this.ma);this.e()&&se(this.e());this.ma=r};function Z(a,b){(!B(a)||!B(b))&&g(Error("A camera needs valid width and height values."));P.call(this);this._className="camera";this.mf=45;this.ic=new O(0,0,100);this.fc=new O(0,0,0);this.Ta=new O(0,1,0);var c=Float32Array,d;d=a/b;var e=1*Math.tan(this.mf*Math.PI/360),f=-e;d=new W([[2/(e*d-f*d),0,(e*d+f*d)/(e*d-f*d),0],[0,2/(e-f),(e+f)/(e-f),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]]);this.of=new c(d.z());this.j=Lf(this,this.ic,this.fc);this.Qa=new Float32Array(this.j.z())}D(Z,P);v=Z.prototype;
v.og=function(a){a instanceof Gc||g(Error("Received no valid zoom event."));a.Ra?this.ff(a.wa):this.gf(a.wa)};v.kg=function(a){a instanceof Dc||g(Error("Received no valid pan event."));this.Pe(a.bb)};v.mg=function(a){a instanceof Fc||g(Error("Received no valid rotate event."));this.rotate(a.bb)};v.view=t("j");v.Gg=function(a){(!y(a)||!(a instanceof W))&&g(Error("Invalid view matrix."));this.j=a;this.Qa=new Float32Array(this.j.z())};v.position=t("ic");
v.Hc=function(a,b,c){(!B(a)||!B(b)||!B(c))&&g(Error("The position was invalid."));this.ic=new O(a,b,c);this.reset()};v.reset=function(){this.j=Lf(this,this.ic,this.fc);this.Qa=new Float32Array(this.j.z())};v.focus=t("fc");v.zg=function(a,b,c){(!B(a)||!B(b)||!B(c))&&g(Error("The focus was invalid."));this.fc=new O(a,b,c);this.reset()};v.Sg=t("Ta");v.Fg=function(a,b,c){(!B(a)||!B(b)||!B(c))&&g(Error("The up-vector was invalid."));this.Ta=new O(a,b,c);this.reset()};
v.Pe=function(a){a instanceof Ec||g(Error("Invalid distance vector for pan operation."));a=new O(-a.x,a.y,0);a=xd(4).translate(a);this.j=new W(a.multiply(this.j));this.Qa=new Float32Array(this.j.z());this.dispatchEvent(new Hc)};
v.rotate=function(a){a instanceof Array&&2==a.length?a=new Ec(a[0],a[1]):a instanceof Ec||g(Error("Invalid distance vector for rotate operation."));var b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=xd(4),d=new O(parseFloat(U(this.j,0,0)),parseFloat(U(this.j,0,1)),parseFloat(U(this.j,0,2))),b=c.rotate(b,new O(parseFloat(U(this.j,1,0)),parseFloat(U(this.j,1,1)),parseFloat(U(this.j,1,2)))),a=c.rotate(a,d);this.j=new W(this.j.multiply(a.multiply(b)));this.Qa=new Float32Array(this.j.z());this.dispatchEvent(new Hc)};
v.ff=function(a){var b=20;y(a)&&!a&&(b=1);a=new O(0,0,b);a=xd(4).translate(a);this.j=new W(a.multiply(this.j));this.Qa=new Float32Array(this.j.z());this.dispatchEvent(new Hc)};v.gf=function(a){var b=30;y(a)&&!a&&(b=1);a=new O(0,0,-b);a=xd(4).translate(a);this.j=new W(a.multiply(this.j));this.Qa=new Float32Array(this.j.z());this.dispatchEvent(new Hc)};
function Lf(a,b,c){(!(b instanceof O)||!(c instanceof O))&&g(Error("3D vectors required for calculating the view."));var d=xd(4),c=new O(b.x-c.x,b.y-c.y,b.b-c.b),c=c.normalize(),a=a.Ta.d();a.Hb(c)&&(a.b+=1.0E-6);var e=Qc(a,c),a=Qc(c,e),e=e.normalize(),a=a.normalize();V(d,0,0,e.x);V(d,0,1,e.y);V(d,0,2,e.b);V(d,0,3,0);V(d,1,0,a.x);V(d,1,1,a.y);V(d,1,2,a.b);V(d,1,3,0);V(d,2,0,c.x);V(d,2,1,c.y);V(d,2,2,c.b);V(d,2,3,0);V(d,3,0,0);V(d,3,1,0);V(d,3,2,0);V(d,3,3,1);b=b.d();return d.translate(b.A())}
C("X.camera",Z);C("X.camera.prototype.view",Z.prototype.view);C("X.camera.prototype.setView",Z.prototype.Gg);C("X.camera.prototype.position",Z.prototype.position);C("X.camera.prototype.setPosition",Z.prototype.Hc);C("X.camera.prototype.focus",Z.prototype.focus);C("X.camera.prototype.setFocus",Z.prototype.zg);C("X.camera.prototype.up",Z.prototype.Sg);C("X.camera.prototype.setUp",Z.prototype.Fg);C("X.camera.prototype.pan",Z.prototype.Pe);C("X.camera.prototype.rotate",Z.prototype.rotate);
C("X.camera.prototype.zoomIn",Z.prototype.ff);C("X.camera.prototype.zoomOut",Z.prototype.gf);function $(a){y(a)||g(Error("An ID to a valid container (<div>..) is required."));a=le(a);(!(na(a)&&1==a.nodeType)||0==a.clientWidth||0==a.clientHeight)&&g(Error("Could not find the given container or it has an undefined size."));P.call(this);this._className="renderer";this.va=a;this.Fb=this.va.clientWidth;this.eb=this.va.clientHeight;this.hc=this.m=this.$c=this.a=this.Na=r;this.gb=new Sd(Fd);this.cd=[];this.xb=this.Ab=this.wb=this.zb=this.vb=this.yb=r;this.p=[0,0,0];this.Yd=r;this.ua=new Db;this.s=
new Db;this.Eb=new Db;this.Xc=new Db;this.dc=new Db;this.lc=new Db;this.bd=new Db;this.ga=this.Sc=r;this.Tc=s;this.config={PROGRESSBAR_ENABLED:p,PICKING_ENABLED:p,ORDERING_ENABLED:p,STATISTICS_ENABLED:s};window.console.log("XTK Release 2 -- 2/12/12 -- http://www.goXTK.com")}D($,P);v=$.prototype;v.width=t("Fb");v.height=t("eb");v.canvas=function(){y(this.Na)||(this.Na=oe("canvas"));return this.Na};v.yf=t("va");v.vf=t("m");v.Of=t("hc");
function Mf(a){y(a.Sc)||(a.Sc=new Kd,L(Mf(a),Ac,a.lg.bind(a)));return a.Sc}v.lg=function(a){this.ga&&this.ga.Jc(100*a.ee)};v.ag=function(a){y(a)&&a instanceof Lc&&Nf(this,a.Fa)};v.Zf=function(a){if(y(a)&&a instanceof Ic){var b=a.nc,a=a.oc,c=this.get(this.Re(b,a));if(c&&(c=c.caption()))(new Jf(this.va,this.va.offsetLeft+b+10,this.va.offsetTop+a+10,this.hc)).e().innerHTML=c}};v.sg=function(){this.xb=this.Ab=this.wb=this.zb=this.vb=this.yb=r;this.p=[0,0,0]};
function Of(a){a.config.PROGRESSBAR_ENABLED&&a.ga&&!a.$d&&(ff(a.ga),a.$d=jf(function(){this.$d=r;this.ga&&(this.ga.yd(),this.ga=r);this.Wb()}.bind(a),700))}v.Te=function(){this.m.reset();this.qb(s,s)};
v.oa=function(){var a=this.canvas();a.width=this.width();a.height=this.height();this.va.appendChild(a);try{var b=a.getContext("experimental-webgl");b||g(Error())}catch(c){alert("WebGL not supported! See http://wiki.goXTK.com/index.php/X:Browsers for instructions.."),g(Error("WebGL not supported! See http://wiki.goXTK.com/index.php/X:Browsers for instructions.."))}try{if(b.clearColor(0,0,0,0),b.enable(b.BLEND),b.blendEquation(b.FUNC_ADD),b.blendFunc(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA),b.enable(b.DEPTH_TEST),
b.depthFunc(b.LEQUAL),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),this.config.PICKING_ENABLED){var d=b.createFramebuffer(),e=b.createRenderbuffer(),f=b.createTexture();b.bindTexture(b.TEXTURE_2D,f);b.texImage2D(b.TEXTURE_2D,0,b.RGB,this.width(),this.height(),0,b.RGB,b.UNSIGNED_BYTE,r);b.bindFramebuffer(b.FRAMEBUFFER,d);b.bindRenderbuffer(b.RENDERBUFFER,e);b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,this.width(),this.height());b.bindRenderbuffer(b.RENDERBUFFER,r);b.framebufferTexture2D(b.FRAMEBUFFER,
b.COLOR_ATTACHMENT0,b.TEXTURE_2D,f,0);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,e);b.bindFramebuffer(b.FRAMEBUFFER,r);this.Yd=d}}catch(h){g(Error("Exception while accessing GL Context!\n"+h))}d=new Hf(a);d.oa();L(d,zc,this.Te.bind(this));L(d,Bc,this.Zf.bind(this));e=new Z(this.width(),this.height());(!y(d)||!(d instanceof Hf))&&g(Error("Could not observe the interactor."));L(d,vc,e.kg.bind(e));L(d,wc,e.mg.bind(e));L(d,xc,e.og.bind(e));L(e,yc,this.qb.bind(this,s,s));
this.Na=a;this.a=b;this.m=e;this.hc=d;Pf(this)};
function Pf(a){var b=new Od;(!y(a.Na)||!y(a.a)||!y(a.m))&&g(Error("Renderer was not initialized properly."));(!y(b)||!(b instanceof Od))&&g(Error("Could not add shaders."));Rd(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.gc);a.a.shaderSource(d,b.mc);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||g(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,a.a.COMPILE_STATUS)||
g(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));b=a.a.createProgram();a.a.attachShader(b,d);a.a.attachShader(b,c);a.a.linkProgram(b);a.a.getProgramParameter(b,a.a.LINK_STATUS)||g(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(b)));a.a.useProgram(b);a.$c=b;Object.keys(Pd).forEach(function(a){a=eval("X.shaders.attributes."+a);this.ua.set(a,this.a.getAttribLocation(this.$c,a));this.a.enableVertexAttribArray(this.ua.get(a))}.bind(a));
Object.keys(Qd).forEach(function(a){a=eval("X.shaders.uniforms."+a);this.s.set(a,this.a.getUniformLocation(this.$c,a))}.bind(a))}v.add=function(a){this.cd.push(a);Nf(this,a)};
function Nf(a,b){(!y(a.Na)||!y(a.a)||!y(a.m))&&g(Error("Renderer was not initialized properly."));(!y(b)||!(b instanceof N))&&g(Error("Illegal object."));var c=s;a.get(b.id())&&(c=p);pc(b)||L(b,qc,a.ag.bind(a));var d=b.id(),e=b.i,f=b.n,h=b.X,i=b.T,k=b.file(),o=b.transform();if(y(i)&&y(i.file())&&i.file().c)c=Mf(a),y(b.T)||g(Error("Internal error during texture loading.")),d=new Image,i=b.T.file().path(),d.src=i,b.T.Sd=d,kc(d,"load",c.Tf.bind(c,b)),Ld(c).set(b.id(),s),Nd(c,0.3);else if(y(k)&&k.c)c=
Mf(a),y(b.file())||g(Error("Internal error during file loading.")),b.i.clear(),b.n.clear(),d=b.file().path(),i=d.split(".").pop(),i=i.toUpperCase(),"TRK"==i||"STL"==i||"FSM"==i||"VTK"==i||"NRRD"==i||g(Error("The "+i+" file format is not supported.")),i=new XMLHttpRequest,L(i,"abort",c.Ee.bind(c,i,b)),L(i,"error",c.Ee.bind(c,i,b)),L(i,"load",c.Sf.bind(c,i,b)),i.open("GET",d,p),i.overrideMimeType("text/plain; charset=x-user-defined"),i.setRequestHeader("Content-Type","text/plain"),i.send(r),Ld(c).set(b.id(),
s);else{if(b.c&&b.Ob())for(var k=b.children(),q=k.length,l=0,l=0;l<q;l++)Nf(a,k[l]);if(0==e.count())Sc(b);else{for(k=0;a.Tc;)k++;a.Tc=p;if(e.c||o.c){q=o.f;k=q.da(new O(e.Ca,e.Da,e.Ea));q=q.da(new O(e.za,e.Aa,e.Ba));if(a.yb===r||k.x<a.yb)a.yb=k.x;if(a.vb===r||q.x>a.vb)a.vb=q.x;if(a.zb===r||k.y<a.zb)a.zb=k.y;if(a.wb===r||q.y>a.wb)a.wb=q.y;if(a.Ab===r||k.b<a.Ab)a.Ab=k.b;if(a.xb===r||q.b>a.xb)a.xb=q.b;a.p=[(a.yb+a.vb)/2,(a.zb+a.wb)/2,(a.Ab+a.xb)/2];Sc(o)}c&&e.c&&(o=a.Eb.get(d),y(o)&&a.a.isBuffer(o.S)&&
a.a.deleteBuffer(o.S));o=r;!c||e.c?(o=a.a.createBuffer(),a.a.bindBuffer(a.a.ARRAY_BUFFER,o),a.a.bufferData(a.a.ARRAY_BUFFER,new Float32Array(e.all()),a.a.STATIC_DRAW),o=new gf(o,e.count(),3),Sc(e)):o=a.Eb.get(d);Nd(Mf(a),0.3);c&&f.c&&(k=a.Eb.get(d),y(k)&&a.a.isBuffer(k.S)&&a.a.deleteBuffer(k.S));k=r;!c||f.c?(k=a.a.createBuffer(),a.a.bindBuffer(a.a.ARRAY_BUFFER,k),a.a.bufferData(a.a.ARRAY_BUFFER,new Float32Array(f.all()),a.a.STATIC_DRAW),k=new gf(k,f.count(),3),Sc(f)):k=a.Xc.get(d);Nd(Mf(a),0.3);c&&
h.c&&(f=a.dc.get(d),y(f)&&a.a.isBuffer(f.S)&&a.a.deleteBuffer(f.S));f=r;0<h.length()&&(!c||h.c?(h.length()!=e.length()&&g(Error("Mismatch between points and point colors.")),e=a.a.createBuffer(),a.a.bindBuffer(a.a.ARRAY_BUFFER,e),a.a.bufferData(a.a.ARRAY_BUFFER,new Float32Array(h.all()),a.a.STATIC_DRAW),f=new gf(e,h.count(),3),Sc(h)):f=a.dc.get(d));Nd(Mf(a),0.3);c&&y(i)&&i.c&&(h=a.lc.get(d),y(h)&&a.a.isBuffer(h.S)&&a.a.deleteBuffer(h.S));h=r;y(i)&&(!c||i.c?(h=b.Sa,y(h)||g(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),
e=a.a.createTexture(),e.vd=i.vd(),a.bd.set(i.id(),e),a.a.bindTexture(a.a.TEXTURE_2D,e),i.Cb?(a.a.texImage2D(a.a.TEXTURE_2D,0,a.a.RGBA,i.kc,i.jc,0,a.a.RGBA,a.a.UNSIGNED_BYTE,i.Cb),a.a.texParameteri(a.a.TEXTURE_2D,a.a.TEXTURE_WRAP_S,a.a.CLAMP_TO_EDGE),a.a.texParameteri(a.a.TEXTURE_2D,a.a.TEXTURE_WRAP_T,a.a.CLAMP_TO_EDGE),a.a.pixelStorei(a.a.UNPACK_FLIP_Y_WEBGL,p)):(a.a.texImage2D(a.a.TEXTURE_2D,0,a.a.RGBA,a.a.RGBA,a.a.UNSIGNED_BYTE,e.vd),a.a.pixelStorei(a.a.UNPACK_FLIP_Y_WEBGL,s)),a.a.texParameteri(a.a.TEXTURE_2D,
a.a.TEXTURE_MAG_FILTER,a.a.LINEAR),a.a.texParameteri(a.a.TEXTURE_2D,a.a.TEXTURE_MIN_FILTER,a.a.LINEAR),a.a.bindTexture(a.a.TEXTURE_2D,r),e=a.a.createBuffer(),a.a.bindBuffer(a.a.ARRAY_BUFFER,e),a.a.bufferData(a.a.ARRAY_BUFFER,new Float32Array(h),a.a.STATIC_DRAW),h=new gf(e,h.length,2),Sc(i)):h=a.lc.get(d));Nd(Mf(a),0.1);!c&&!a.gb.add(b)&&g(Error("Could not add object to this renderer."));a.Eb.set(d,o);a.Xc.set(d,k);a.dc.set(d,f);a.lc.set(d,h);Sc(b);a.Tc=s}}}
v.Wb=function(){(!this.Na||!this.a||!this.m)&&g(Error("The renderer was not initialized properly."));y(this.Zd)||(Md(Mf(this))?this.ga?(Of(this),eval("this.onShowtime()")):this.qb(s,p):(this.config.PROGRESSBAR_ENABLED&&!this.ga&&(this.ga=new ef(this.va,0)),this.Zd=jf(function(){this.Zd=r;this.Wb()}.bind(this),100)))};v.ng=aa();v.get=function(a){y(a)||g(Error("Invalid object id."));for(var b=this.gb.ba(),c=0,d=b.length,c=0;c<d;c++)if(b[c].id()==a)return b[c];return r};
v.Re=function(a,b){if(this.config.PICKING_ENABLED){this.qb(p,s);var c=new Uint8Array(4);this.a.readPixels(a,this.eb-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);var d=Math.round(10*(c[0]/255)),e=Math.round(10*(c[1]/255)),c=Math.round(10*(c[2]/255));return 100*d+10*e+c}return-1};
v.qb=function(a,b){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.Yd):this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var c=this.m.of,d=this.m.Qa;this.a.uniformMatrix4fv(this.s.get("perspective"),s,c);this.a.uniformMatrix4fv(this.s.get("view"),s,d);c=this.p;this.a.uniform3f(this.s.get("center"),parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2]));if(this.config.ORDERING_ENABLED){var e=s,c=this.gb.ba(),d=c.length,f;for(f=0;f<d;++f){var h=
c[f];1!=h.opacity()&&(e=h.i.cc,e=new O(e[0],e[1],e[2]),h=h.transform().f.da(e),h=this.m.view().da(h),h=Oc(this.m.focus(),h),c[f].qc=h,e=p)}if(e){this.gb.clear();for(f=0;f<d;++f)this.gb.add(c[f])}}if(c=!a&&y(b)&&b&&this.config.STATISTICS_ENABLED)var i=0,k=0,o=0,q=0;f=this.cd.length;for(d=0;d<f;++d)if(h=this.cd[d],h instanceof Qf){var l=new O(1,0,0),l=this.m.view().da(l),e=Oc(this.m.focus(),l),l=new O(-1,0,0),l=this.m.view().da(l),m=Oc(this.m.focus(),l),l=new O(0,1,0),l=this.m.view().da(l),j=Oc(this.m.focus(),
l),l=new O(0,-1,0),l=this.m.view().da(l),u=Oc(this.m.focus(),l),l=new O(0,0,1),l=this.m.view().da(l),w=Oc(this.m.focus(),l),l=new O(0,0,-1),l=this.m.view().da(l),l=Oc(this.m.focus(),l),z=Math.max(e,j,w,m,u,l);z==e||z==m?Rf(h,0):z==j||z==u?Rf(h,1):(z==w||z==l)&&Rf(h,2)}f=this.gb.ba();h=f.length;for(d=0;d<h;++d)(e=f[d])?e.Rd()&&(j=e.id(),w=e.Ad(),m=this.Eb.get(j),l=this.Xc.get(j),z=this.dc.get(j),u=this.lc.get(j),this.a.bindBuffer(this.a.ARRAY_BUFFER,m.S),this.a.vertexAttribPointer(this.ua.get("vertexPosition"),
m.fb,this.a.FLOAT,s,0,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,l.S),this.a.vertexAttribPointer(this.ua.get("vertexNormal"),l.fb,this.a.FLOAT,s,0,0),a?this.a.uniform1i(this.s.get("usePicking"),p):this.a.uniform1i(this.s.get("usePicking"),s),y(z)&&!a&&!w?(this.a.uniform1i(this.s.get("useObjectColor"),s),this.a.bindBuffer(this.a.ARRAY_BUFFER,z.S),this.a.vertexAttribPointer(this.ua.get("vertexColor"),z.fb,this.a.FLOAT,s,0,0)):(l=1,w&&!a&&(l=0),this.a.uniform1i(this.s.get("useObjectColor"),l),w=e.color(),
a&&(999<j&&g(Error("Id out of bounds.")),w=Math.floor(0.01*j),l=Math.floor(0.1*j)-10*w,w=[w/10,l/10,(j-100*w-10*l)/10]),this.a.uniform3f(this.s.get("objectColor"),parseFloat(w[0]),parseFloat(w[1]),parseFloat(w[2])),this.a.vertexAttribPointer(this.ua.get("vertexColor"),m.fb,this.a.FLOAT,s,0,0)),this.a.uniform1f(this.s.get("objectOpacity"),parseFloat(e.opacity())),y(e.T)&&y(u)&&!a?(this.a.uniform1i(this.s.get("useTexture"),p),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,
this.bd.get(e.T.id())),this.a.uniform1i(this.s.get("textureSampler"),0),this.a.bindBuffer(this.a.ARRAY_BUFFER,u.S),this.a.vertexAttribPointer(this.ua.get("vertexTexturePos"),u.fb,this.a.FLOAT,s,0,0)):(this.a.uniform1i(this.s.get("useTexture"),s),this.a.vertexAttribPointer(this.ua.get("vertexTexturePos"),m.fb,this.a.FLOAT,s,0,0)),e instanceof Sf&&y(e.ed)&&(j=e.ed,this.a.uniform1f(this.s.get("volumeLowerThreshold"),j._lowerThreshold),this.a.uniform1f(this.s.get("volumeUpperThreshold"),j._upperThreshold),
u=j.Db,this.a.uniform1f(this.s.get("volumeScalarMin"),u[0]),this.a.uniform1f(this.s.get("volumeScalarMax"),u[1]),j._volumeRendering&&this.a.uniform1f(this.s.get("objectOpacity"),parseFloat(j.opacity()))),this.a.uniformMatrix4fv(this.s.get("objectTransform"),s,yd(e.transform())),j=1,"POINTS"==e.type()&&(j=e.Hd()),this.a.uniform1f(this.s.get("pointSize"),j),j=-1,e.type()==Cd?(j=this.a.TRIANGLES,c&&(k+=m.ya/3)):e.type()==Zc?(this.a.lineWidth(e.lineWidth()),j=this.a.LINES,c&&(o+=m.ya/2)):"POINTS"==e.type()?
(j=this.a.POINTS,c&&(q+=m.ya)):"TRIANGLE_STRIPS"==e.type()?(j=this.a.TRIANGLE_STRIP,c&&(k+=m.ya/3)):"POLYGONS"==e.type()&&(j=0==m.ya%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,c&&(k+=m.ya/3)),c&&(i+=m.ya),this.a.drawArrays(j,0,m.ya)):g(Error("Could not retrieve object for (re-)drawing!"));c&&(i="Objects: "+h+" | "+("Vertices: "+i+" | ")+("Triangles: "+Math.round(k)+" | "),i=i+("Lines: "+o+" | ")+("Points: "+q+" | ")+("Textures: "+this.bd.aa()),window.console.log(i))};C("X.renderer",$);
C("X.renderer.prototype.width",$.prototype.width);C("X.renderer.prototype.height",$.prototype.height);C("X.renderer.prototype.canvas",$.prototype.canvas);C("X.renderer.prototype.container",$.prototype.yf);C("X.renderer.prototype.camera",$.prototype.vf);C("X.renderer.prototype.interactor",$.prototype.Of);C("X.renderer.prototype.resetBoundingBox",$.prototype.sg);C("X.renderer.prototype.resetViewAndRender",$.prototype.Te);C("X.renderer.prototype.init",$.prototype.oa);C("X.renderer.prototype.add",$.prototype.add);
C("X.renderer.prototype.onShowtime",$.prototype.ng);C("X.renderer.prototype.get",$.prototype.get);C("X.renderer.prototype.pick",$.prototype.Re);C("X.renderer.prototype.render",$.prototype.Wb);function Sf(a,b,c,d,e){(!y(a)||!(a instanceof Array)||3!=a.length)&&g(Error("Invalid center."));(!y(b)||!(b instanceof Array)||3!=b.length)&&g(Error("Invalid front direction."));(!y(c)||!(c instanceof Array)||3!=c.length)&&g(Error("Invalid up direction."));B(d)||g(Error("Invalid width."));B(e)||g(Error("Invalid height."));N.call(this);this._className="slice";this.p=a;this.Mc=b;this.Ta=c;this.Fb=d;this.eb=e;this.Sa=[0,1,0,0,1,1,1,1,1,0,0,0];this.ed=r;this.na()}D(Sf,N);
Sf.prototype.na=function(){this.i.clear();var a=new O(this.Mc[0],this.Mc[1],this.Mc[2]),b=new O(this.Ta[0],this.Ta[1],this.Ta[2]),c=Qc(b,a),d=new O(this.p[0],this.p[1],this.p[2]),e=new O(1,1,1);1==a.x?(e=new O(this.p[2],this.eb/2,this.Fb/2),this.Sa=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new O(this.Fb/2,this.p[2],this.eb/2),this.Sa=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new O(this.Fb/2,this.eb/2,this.p[2]));var f=Pc(c.d().A(),b.d().A()),f=new O(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var h=Pc(c.d().A(),b),
h=new O(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var i=Pc(c,b.d().A()),i=new O(i.x*e.x,i.y*e.y,i.b*e.b);i.add(d);var k=i,b=Pc(c,b),b=new O(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=h;this.i.add(f.x,f.y,f.b);this.i.add(h.x,h.y,h.b);this.i.add(i.x,i.y,i.b);this.i.add(k.x,k.y,k.b);this.i.add(b.x,b.y,b.b);this.i.add(d.x,d.y,d.b);this.n.add(a.x,a.y,a.b);this.n.add(a.x,a.y,a.b);this.n.add(a.x,a.y,a.b);this.n.add(a.x,a.y,a.b);this.n.add(a.x,a.y,a.b);this.n.add(a.x,a.y,a.b)};C("X.slice",Sf);function Qf(){N.call(this);this._className="volume";this.p=[0,0,0];this.fa=[10,10,10];this.I=[1,1,1];this.Qc=this._indexZ=this.Pc=this._indexY=this.Oc=this._indexX=0;this.ae=new N;this.be=new N;this.ce=new N;this._lowerThreshold=0;this._upperThreshold=1E3;this.Db=[0,1E3];this._volumeRendering=s;this.fd=0}D(Qf,N);v=Qf.prototype;
v.na=function(){this.children().length=0;this.children().push(this.ae);this.children().push(this.be);this.children().push(this.ce);for(var a=0,a=0;3>a;a++){for(var b=(this.fa[a]-1)/2,c=b,d=0,d=0;d<this.fa[a];d++){var e=-b*this.I[a]+d*this.I[a],f=[[e,this.p[1],this.p[2]],[this.p[0],e,this.p[2]],[this.p[0],this.p[1],e]],e=this.children()[a].children(),h=0,i=0;0==a?(h=this.fa[2]*this.I[2]-this.I[2],i=this.fa[1]*this.I[1]-this.I[1]):1==a?(h=this.fa[0]*this.I[0]-this.I[0],i=this.fa[2]*this.I[2]-this.I[2]):
2==a&&(h=this.fa[0]*this.I[0]-this.I[0],i=this.fa[1]*this.I[1]-this.I[1]);f=new Sf(f[a],[[1,0,0],[0,1,0],[0,0,1]][a],[[0,1,0],[0,0,-1],[0,1,0]][a],h,i);f.ed=this;f.G(d==c);e.push(f)}0==a?this.Oc=this._indexX=c:1==a?this.Pc=this._indexY=c:2==a&&(this.Qc=this._indexZ=c)}this.c=p};
v.Tb=function(){this.c=p;if(this._volumeRendering)Rf(this,this.fd);else{if(this.c)for(var a=0,a=0;3>a;a++){var b=this.children()[a];b.G(s);b.Fc(1)}for(a=0;3>a;a++){var b=this.children()[a],c=0,d=0;0==a?(c=this._indexX,d=this.Oc,this.Oc=this._indexX):1==a?(c=this._indexY,d=this.Pc,this.Pc=this._indexY):2==a&&(c=this._indexZ,d=this.Qc,this.Qc=this._indexZ);b.children()[parseInt(d,10)].G(s);b.children()[parseInt(c,10)].G(p)}}Qf.C.Tb.call(this)};v.Af=t("fa");v.wg=t("Db");
v.$e=function(a,b){(!y(a)||!B(a)||!y(b)||!B(b)||a>b||a<this.Db[0]||b>this.Db[1])&&g(Error("Invalid threshold range."));this._lowerThreshold=a;this._upperThreshold=b};v.Hg=aa();function Rf(a,b){if(!(!a.c&&!a._volumeRendering||!a.c&&b==a.fd)){for(var c=0,c=0;3>c;c++){var d=a.children()[c],e=s;c==b&&(e=p);d.G(e);d.Fc(a._opacity)}a.fd=b}}C("X.volume",Qf);C("X.volume.prototype.dimensions",Qf.prototype.Af);C("X.volume.prototype.scalarRange",Qf.prototype.wg);C("X.volume.prototype.setVolumeRendering",Qf.prototype.Hg);
C("X.volume.prototype.threshold",Qf.prototype.$e);C("X.volume.prototype.modified",Qf.prototype.Tb);function Tf(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new R(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));h.push(new gd(c.nb(e.Ma(d)),e))}this.l=[];for(var a=a||{},c=new R(a.jd||[0,0,0]),d=a.ja||1,e=a.Ld||16,a=a.Jg||8,f=[],h,i=0;i<e;i++)for(var k=0;k<a;k++)h=[],b(i/e,k/a),0<k&&b((i+1)/e,k/a),k<a-1&&b((i+1)/e,(k+1)/a),b(i/e,(k+1)/a),f.push(new id(h));return md(f)}D(Tf,ld);function Uf(a,b){(!y(a)||!(a instanceof Array)||3!=a.length)&&g(Error("Invalid center."));B(b)||g(Error("Invalid radius."));N.call(this);this._className="Sphere";this.p=a;this.Zc=b;this.ad=32;this.sf=16;this.na()}D(Uf,N);Uf.prototype.na=function(){Ed(this,new Tf({jd:this.p,ja:this.Zc,Ld:this.ad,Jg:this.sf}))};C("X.sphere",Uf);function Vf(a){function b(a,b,d){b=2*b*Math.PI;b=k.Ma(Math.cos(b)).nb(o.Ma(Math.sin(b)));a=c.nb(e.Ma(a)).nb(b.Ma(f));d=b.Ma(1-Math.abs(d)).nb(h.Ma(d));return new gd(a,d)}this.l=[];for(var a=a||{},c=new R(a.start||[0,-1,0]),d=new R(a.end||[0,1,0]),e=d.Sb(c),f=a.ja||1,a=a.Ld||16,h=e.$b(),i=0.5<Math.abs(h.y()),k=(new R(i,!i,0)).nd(h).$b(),o=k.nd(h).$b(),i=new gd(c,h.Cd()),d=new gd(d,h.$b()),q=[],l=0;l<a;l++){var m=l/a,j=(l+1)/a;q.push(new id([i,b(0,m,-1),b(0,j,-1)]));q.push(new id([b(0,j,0),b(0,m,0),
b(1,m,0),b(1,j,0)]));q.push(new id([d,b(1,j,1),b(1,m,1)]))}return md(q)}D(Vf,ld);function Wf(a,b,c){(!y(a)||!(a instanceof Array)||3!=a.length)&&g(Error("Invalid start position."));(!y(b)||!(b instanceof Array)||3!=b.length)&&g(Error("Invalid end position."));B(c)||g(Error("Invalid radius."));N.call(this);this._className="cylinder";this.tf=a;this.lf=b;this.Zc=c;this.ad=32;this.na()}D(Wf,N);Wf.prototype.na=function(){Ed(this,new Vf({start:this.tf,end:this.lf,ja:this.Zc,Ld:this.ad}))};C("X.cylinder",Wf);function Xf(a){this.l=[];var a=a||{},b=new R(a.jd||[0,0,0]),c=!a.ja?[1,1,1]:a.ja.length?a.ja:[a.ja,a.ja,a.ja];return md([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new id(a[0].map(function(e){e=new R(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new gd(e,new R(a[1]))}))}))}D(Xf,ld);function Yf(a,b,c,d){(!y(a)||!(a instanceof Array)||3!=a.length)&&g(Error("Invalid center."));(!B(b)||!B(c)||!B(d))&&g(Error("Invalid radii."));N.call(this);this._className="cube";this.p=a;this.pf=b;this.qf=c;this.rf=d;this.Sa=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];this.na()}D(Yf,N);Yf.prototype.na=function(){Ed(this,new Xf({jd:this.p,ja:[this.pf,this.qf,this.rf]}))};C("X.cube",Yf);
